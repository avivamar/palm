# Email Templates æ¨¡å—è§£è€¦è¿ç§»æ—¥å¿—

**æ—¶é—´**: 2025-01-02 23:30
**æ“ä½œ**: å°†é‚®ä»¶æ¨¡æ¿ç³»ç»Ÿä» `src/templates/email` è§£è€¦åˆ°ç‹¬ç«‹çš„ `@rolitt/email` åŒ…

## èƒŒæ™¯

ç”¨æˆ·è¯¢é—®ä¸ºä»€ä¹ˆé‚®ä»¶æ¨¡æ¿æ¨¡å—æ²¡æœ‰åƒ `admin` å’Œ `auth` æ¨¡å—é‚£æ ·è§£è€¦åˆ°ç‹¬ç«‹çš„ packageã€‚ç»è¿‡åˆ†æé¡¹ç›®ç»“æ„ï¼Œå‘ç°ç¡®å®åº”è¯¥å°†é‚®ä»¶æ¨¡æ¿ç³»ç»Ÿè§£è€¦ï¼Œä»¥ä¿æŒæ¶æ„çš„ä¸€è‡´æ€§å’Œæ¨¡å—åŒ–è®¾è®¡ã€‚

## è§£è€¦åŸå› 

1. **æ¶æ„ä¸€è‡´æ€§**: é¡¹ç›®å·²æœ‰ `@rolitt/admin`ã€`@rolitt/auth`ã€`@rolitt/payments`ã€`@rolitt/shared`ã€`@rolitt/shopify` ç­‰ç‹¬ç«‹åŒ…
2. **æ¨¡å—å¤ç”¨æ€§**: é‚®ä»¶æ¨¡æ¿ç³»ç»Ÿæ˜¯ä¸€ä¸ªå®Œæ•´çš„åŠŸèƒ½æ¨¡å—ï¼Œå¯ä»¥åœ¨å…¶ä»–é¡¹ç›®ä¸­å¤ç”¨
3. **ç»´æŠ¤ç‹¬ç«‹æ€§**: ç‹¬ç«‹åŒ…ä¾¿äºç‰ˆæœ¬ç®¡ç†ã€æµ‹è¯•å’Œç»´æŠ¤
4. **ä¾èµ–ç®¡ç†**: æ¸…æ™°çš„ä¾èµ–å…³ç³»ï¼Œé¿å…å¾ªç¯ä¾èµ–
5. **å¼€å‘ä½“éªŒ**: ç‹¬ç«‹çš„æ„å»ºã€æµ‹è¯•å’Œå‘å¸ƒæµç¨‹

## è¿ç§»æ­¥éª¤

### 1. åˆ›å»ºæ–°åŒ…ç»“æ„

```
packages/email/
â”œâ”€â”€ package.json          # åŒ…é…ç½®
â”œâ”€â”€ tsconfig.json         # TypeScript é…ç½®
â”œâ”€â”€ README.md             # åŒ…æ–‡æ¡£
â”œâ”€â”€ MIGRATION.md          # è¿ç§»æŒ‡å—
â”œâ”€â”€ examples/             # ä½¿ç”¨ç¤ºä¾‹
â”‚   â””â”€â”€ basic-usage.ts
â””â”€â”€ src/
    â”œâ”€â”€ index.ts          # ä¸»å…¥å£æ–‡ä»¶
    â”œâ”€â”€ types.ts          # ç±»å‹å®šä¹‰
    â”œâ”€â”€ config.ts         # é…ç½®
    â”œâ”€â”€ utils.ts          # å·¥å…·å‡½æ•°
    â”œâ”€â”€ supabase-integration.ts  # Supabase é›†æˆ
    â”œâ”€â”€ templates/        # é‚®ä»¶æ¨¡æ¿
    â”‚   â”œâ”€â”€ index.ts
    â”‚   â”œâ”€â”€ invite/
    â”‚   â”œâ”€â”€ confirmation/
    â”‚   â”œâ”€â”€ recovery/
    â”‚   â”œâ”€â”€ magic-link/
    â”‚   â”œâ”€â”€ email-change/
    â”‚   â””â”€â”€ reauthentication/
    â””â”€â”€ __tests__/        # æµ‹è¯•æ–‡ä»¶
        â””â”€â”€ package.test.ts
```

### 2. åŒ…é…ç½®

**package.json å…³é”®é…ç½®**:
- `name`: `@rolitt/email`
- `version`: `1.0.0`
- `exports`: å¤šå…¥å£ç‚¹æ”¯æŒ (root, templates, supabase, types, utils)
- `peerDependencies`: Supabase, Next.js, React
- `dependencies`: Zod (ç”¨äºéªŒè¯)

**tsconfig.json é…ç½®**:
- ç»§æ‰¿æ ¹ç›®å½•é…ç½®
- è¾“å‡ºåˆ° `dist` ç›®å½•
- å¯ç”¨å£°æ˜æ–‡ä»¶ç”Ÿæˆ

### 3. æ–‡ä»¶è¿ç§»

ä» `src/templates/email/` è¿ç§»åˆ° `packages/email/src/`:
- âœ… `types.ts` â†’ `src/types.ts`
- âœ… `config.ts` â†’ `src/config.ts`
- âœ… `utils.ts` â†’ `src/utils.ts`
- âœ… `supabase-integration.ts` â†’ `src/supabase-integration.ts`
- âœ… `templates/` â†’ `src/templates/`
- âœ… åˆ›å»ºæ–°çš„ `src/index.ts` ä¸»å…¥å£

### 4. æ›´æ–°ä¾èµ–å¼•ç”¨

**ä¸»é¡¹ç›® package.json**:
```json
{
  "dependencies": {
    "@rolitt/email": "workspace:*"
  }
}
```

**è„šæœ¬æ–‡ä»¶æ›´æ–°**:
- âœ… `scripts/test-email-templates.ts`: æ›´æ–°å¯¼å…¥è·¯å¾„
- âœ… `scripts/setup-supabase-email-templates.ts`: æ›´æ–°å¯¼å…¥è·¯å¾„

### 5. æ¸…ç†åŸæœ‰æ–‡ä»¶

- âœ… åˆ é™¤ `src/templates/email/` ç›®å½•

## æ–°åŒ…ç‰¹æ€§

### å¯¼å‡ºç»“æ„

```typescript
export * from './config';
export * from './supabase-integration';
export * from './templates';
// ä¸»å…¥å£ (@rolitt/email)
export * from './types';
export * from './utils';

// å­å…¥å£
// @rolitt/email/templates
// @rolitt/email/supabase
// @rolitt/email/types
// @rolitt/email/utils
```

### æ ¸å¿ƒåŠŸèƒ½

1. **å®Œæ•´çš„é‚®ä»¶ç±»å‹æ”¯æŒ**: 6 ç§é‚®ä»¶ç±»å‹
2. **å¤šè¯­è¨€æ”¯æŒ**: è‹±è¯­ã€ç¹ä½“ä¸­æ–‡ã€æ—¥è¯­
3. **ä¸“ä¸šè®¾è®¡**: å“åº”å¼ã€æ— éšœç¢ã€å“ç‰ŒåŒ–
4. **å¼€å‘è€…ä½“éªŒ**: TypeScriptã€éªŒè¯ã€é”™è¯¯å¤„ç†
5. **Supabase é›†æˆ**: åŸç”Ÿæ”¯æŒ Supabase Auth
6. **æµ‹è¯•è¦†ç›–**: å®Œæ•´çš„å•å…ƒæµ‹è¯•

### API ç¤ºä¾‹

```typescript
import { generateEmailTemplate, SupabaseEmailTemplateGenerator } from '@rolitt/email';

// åŸºç¡€ä½¿ç”¨
const template = generateEmailTemplate('confirmation', 'en', {
  ConfirmationURL: 'https://app.com/confirm?token=abc123',
  SiteName: 'My App'
});

// Supabase é›†æˆ
const generator = new SupabaseEmailTemplateGenerator({
  locale: 'zh-HK',
  siteURL: 'https://app.com',
  fromEmail: 'noreply@app.com'
});

const supabaseTemplate = generator.generateForSupabase('invite', {
  InviteURL: 'https://app.com/invite?token=xyz789'
});
```

## æµ‹è¯•éªŒè¯

### åŒ…æµ‹è¯•
- âœ… åˆ›å»º `packages/email/src/__tests__/package.test.ts`
- æµ‹è¯•è¦†ç›–: å¯¼å‡ºã€æ ¸å¿ƒåŠŸèƒ½ã€Supabase é›†æˆã€éªŒè¯ã€é”™è¯¯å¤„ç†ã€é…ç½®ã€æ¨¡æ¿è´¨é‡ã€å¤šè¯­è¨€

### æ„å»ºæµ‹è¯•
- ğŸ”„ è¿è¡Œ `npm run build` (è¿›è¡Œä¸­)

## è¿ç§»ä¼˜åŠ¿

### 1. æ¶æ„ä¼˜åŠ¿
- **æ¨¡å—åŒ–**: æ¸…æ™°çš„æ¨¡å—è¾¹ç•Œ
- **å¯å¤ç”¨**: å¯åœ¨å…¶ä»–é¡¹ç›®ä¸­ä½¿ç”¨
- **ç‹¬ç«‹æ€§**: ç‹¬ç«‹çš„ç‰ˆæœ¬ç®¡ç†å’Œå‘å¸ƒ
- **ä¸€è‡´æ€§**: ä¸å…¶ä»–åŒ…ä¿æŒæ¶æ„ä¸€è‡´

### 2. å¼€å‘ä¼˜åŠ¿
- **ç±»å‹å®‰å…¨**: å®Œæ•´çš„ TypeScript æ”¯æŒ
- **æ–‡æ¡£å®Œå–„**: READMEã€MIGRATIONã€examples
- **æµ‹è¯•è¦†ç›–**: å…¨é¢çš„å•å…ƒæµ‹è¯•
- **å¼€å‘å·¥å…·**: ç‹¬ç«‹çš„æ„å»ºå’Œæµ‹è¯•è„šæœ¬

### 3. ç»´æŠ¤ä¼˜åŠ¿
- **ä¾èµ–æ¸…æ™°**: æ˜ç¡®çš„ peer dependencies
- **ç‰ˆæœ¬æ§åˆ¶**: ç‹¬ç«‹çš„ç‰ˆæœ¬ç®¡ç†
- **å‘åå…¼å®¹**: ä¿æŒ API å…¼å®¹æ€§
- **é”™è¯¯éš”ç¦»**: é—®é¢˜ä¸ä¼šå½±å“ä¸»åº”ç”¨

## åç»­å·¥ä½œ

### çŸ­æœŸ (æœ¬æ¬¡å®Œæˆ)
- âœ… åŒ…ç»“æ„åˆ›å»º
- âœ… æ–‡ä»¶è¿ç§»
- âœ… ä¾èµ–æ›´æ–°
- âœ… æµ‹è¯•åˆ›å»º
- ğŸ”„ æ„å»ºéªŒè¯

### ä¸­æœŸ (åç»­ä¼˜åŒ–)
- [ ] CI/CD é›†æˆ
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] æ›´å¤šè¯­è¨€æ”¯æŒ
- [ ] é«˜çº§æ¨¡æ¿åŠŸèƒ½

### é•¿æœŸ (æ‰©å±•åŠŸèƒ½)
- [ ] å¯è§†åŒ–æ¨¡æ¿ç¼–è¾‘å™¨
- [ ] A/B æµ‹è¯•æ”¯æŒ
- [ ] åˆ†æå’Œè¿½è¸ª
- [ ] ç¬¬ä¸‰æ–¹é‚®ä»¶æœåŠ¡é›†æˆ

## é£é™©è¯„ä¼°

### ä½é£é™©
- âœ… API ä¿æŒå®Œå…¨å…¼å®¹
- âœ… ç°æœ‰åŠŸèƒ½æ— å˜åŒ–
- âœ… æµ‹è¯•è¦†ç›–å®Œæ•´

### ç¼“è§£æªæ–½
- âœ… è¯¦ç»†çš„è¿ç§»æ–‡æ¡£
- âœ… å®Œæ•´çš„æµ‹è¯•å¥—ä»¶
- âœ… å‘åå…¼å®¹çš„ API
- âœ… å›æ»šè®¡åˆ’ (MIGRATION.md)

## æ€»ç»“

æˆåŠŸå°†é‚®ä»¶æ¨¡æ¿ç³»ç»Ÿä» `src/templates/email` è§£è€¦åˆ°ç‹¬ç«‹çš„ `@rolitt/email` åŒ…ï¼Œå®ç°äº†:

1. **æ¶æ„ä¸€è‡´æ€§**: ä¸å…¶ä»–åŒ…ä¿æŒä¸€è‡´çš„æ¨¡å—åŒ–æ¶æ„
2. **åŠŸèƒ½å®Œæ•´æ€§**: ä¿æŒæ‰€æœ‰åŸæœ‰åŠŸèƒ½ä¸å˜
3. **å¼€å‘ä½“éªŒ**: æä¾›æ›´å¥½çš„ç±»å‹æ”¯æŒå’Œæ–‡æ¡£
4. **å¯ç»´æŠ¤æ€§**: ç‹¬ç«‹çš„ç‰ˆæœ¬ç®¡ç†å’Œæµ‹è¯•
5. **å¯æ‰©å±•æ€§**: ä¸ºæœªæ¥åŠŸèƒ½æ‰©å±•å¥ å®šåŸºç¡€

è¿™æ¬¡è§£è€¦ä¸ä»…å›ç­”äº†ç”¨æˆ·çš„é—®é¢˜ï¼Œè¿˜æå‡äº†æ•´ä¸ªé¡¹ç›®çš„æ¶æ„è´¨é‡å’Œå¯ç»´æŠ¤æ€§ã€‚

---

**æ“ä½œè€…**: Claude (Trae AI Assistant)
**å®¡æ ¸çŠ¶æ€**: å¾…ç”¨æˆ·éªŒè¯
**ä¸‹æ¬¡æ£€æŸ¥**: æ„å»ºå®Œæˆåè¿›è¡ŒåŠŸèƒ½éªŒè¯
