# **Palm å®˜æ–¹ç½‘ç«™**

åŸºäº Next.js 15 çš„ç°ä»£åŒ–äº§å“è¥é”€ä¸ç”µå•†å¹³å°ï¼Œé›†æˆå®Œæ•´çš„æ”¯ä»˜ç³»ç»Ÿã€ç”¨æˆ·ç®¡ç†ã€å†…å®¹ç®¡ç†å’Œè¥é”€è‡ªåŠ¨åŒ–åŠŸèƒ½ã€‚

## **ğŸš€ é¡¹ç›®æ¦‚è§ˆ**

Palm AI æ˜¯ä¸€ä¸ªåŸºäºæ‰‹æŒå›¾åƒ + ä¸ªäººå‡ºç”Ÿä¿¡æ¯ï¼ˆæ—¥æœŸã€æ—¶è¾°ï¼‰åˆ†æç”¨æˆ·ä¸ªæ€§ã€å¥åº·è¶‹åŠ¿ã€è¿åŠ¿å‘¨æœŸå’Œæ½œåŠ›çš„ AI äº§å“ã€‚
ç»“åˆä¸œæ–¹æŒçº¹å­¦ã€è¥¿æ–¹æ˜Ÿåº§å¡”ç½—å­¦ï¼Œä»¥åŠå¤§æ¨¡å‹æ™ºèƒ½è§£æï¼Œè¾“å‡ºç®€ç‰ˆä¸å®Œæ•´ç‰ˆæŠ¥å‘Šï¼Œé‡‡ç”¨è®¢é˜…åˆ¶é€æ­¥å»ºç«‹ç”¨æˆ·ç•™å­˜ã€‚

### **ğŸ¯ æ ¸å¿ƒåŠŸèƒ½**

#### **ğŸ’¼ ä¸šåŠ¡æ ¸å¿ƒåŠŸèƒ½**
- **ğŸ›ï¸ é¢„è®¢ç³»ç»Ÿ**: å®Œæ•´çš„äº§å“é¢„è®¢æµç¨‹ï¼Œæ”¯æŒå¤šé¢œè‰²é€‰æ‹©å’Œè§„æ ¼é…ç½®
- **ğŸ’³ æ”¯ä»˜å¤„ç†**: Stripe å¼‚æ­¥æ”¯ä»˜æ¶æ„ï¼Œæ”¯æŒå¤šç§æ”¯ä»˜æ–¹å¼å’Œè®¢é˜…æ¨¡å¼
- **ğŸ¯ æ¨èè¥é”€**: æ™ºèƒ½æ¨èç³»ç»Ÿï¼Œæ”¯æŒå¤šçº§æ¨èå¥–åŠ±å’Œç²¾å‡†è¥é”€
- **ğŸ“¦ Shopify é›†æˆ**: å®Œæ•´çš„è®¢å•åŒæ­¥ã€äº§å“ç®¡ç†ã€åº“å­˜æ§åˆ¶å’Œå®æ—¶æ•°æ®åŒæ­¥
- **ğŸ“§ è¥é”€è‡ªåŠ¨åŒ–**: Klaviyo é›†æˆï¼Œè‡ªåŠ¨åŒ–é‚®ä»¶è¥é”€å’Œç”¨æˆ·è¡Œä¸ºè¿½è¸ª
- **ğŸ“ˆ æ•°æ®åˆ†æ**: å¤šå¹³å°åˆ†æå·¥å…·é›†æˆï¼Œå®æ—¶ä¸šåŠ¡æ´å¯Ÿ

#### **ğŸ”§ æŠ€æœ¯æ ¸å¿ƒåŠŸèƒ½**
- **ğŸ” åŒè®¤è¯ç³»ç»Ÿ**: Supabase Auth (ä¸»ç³»ç»Ÿ) + Firebase Auth (å®¹ç¾å¤‡ä»½)
- **ğŸ“Š ç®¡ç†åå°**: è®¢å•ç®¡ç†ã€ç”¨æˆ·ç®¡ç†ã€webhook æ—¥å¿—ç›‘æ§å’Œç³»ç»Ÿå¥åº·æ£€æŸ¥
- **ğŸ–¼ï¸ å›¾ç‰‡ç®¡ç†**: æ™ºèƒ½å›¾ç‰‡ä¸Šä¼ ã€å‹ç¼©ã€CDN åˆ†å‘å’Œå¤šæ ¼å¼æ”¯æŒ
- **ğŸ“§ é‚®ä»¶æ¨¡æ¿**: æ”¯æŒ 6 ç§é‚®ä»¶ç±»å‹å’Œ 4 ç§è¯­è¨€çš„ä¸“ä¸šé‚®ä»¶æ¨¡æ¿ç³»ç»Ÿ
- **ğŸ“ å†…å®¹ç®¡ç†**: æ”¯æŒ Notion å’Œ Markdown çš„åšå®¢ç³»ç»Ÿ
- **ğŸŒ å›½é™…åŒ–**: æ”¯æŒè‹±è¯­ã€è¥¿ç­ç‰™è¯­ã€æ—¥è¯­ã€ç¹ä½“ä¸­æ–‡çš„å®Œæ•´æœ¬åœ°åŒ–

## **ğŸ—ï¸ æŠ€æœ¯æ¶æ„**

### **ğŸ“¦ Monorepo åŒ…ç®¡ç†æ¶æ„**

**8 ä¸ªç‹¬ç«‹åŠŸèƒ½åŒ…ï¼Œæ¨¡å—åŒ–è®¾è®¡ï¼Œç‹¬ç«‹å¼€å‘å’Œéƒ¨ç½²**ï¼š

- **`@rolitt/payments`**: æ”¯ä»˜ç³»ç»ŸåŒ… - Stripe é›†æˆã€è®¢é˜…ç®¡ç†ã€å¼‚æ­¥æ”¯ä»˜å¤„ç†
- **`@rolitt/referral`**: æ¨èç³»ç»ŸåŒ… - å¤šçº§æ¨èã€å¥–åŠ±è®¡ç®—ã€è¥é”€è¿½è¸ª
- **`@rolitt/image-upload`**: å›¾ç‰‡ä¸Šä¼ åŒ… - æ™ºèƒ½å‹ç¼©ã€CDN åˆ†å‘ã€å¤šæ ¼å¼æ”¯æŒ
- **`@rolitt/auth`**: è®¤è¯ç³»ç»ŸåŒ… - åŒè®¤è¯æ¶æ„ã€ä¼šè¯ç®¡ç†ã€æƒé™æ§åˆ¶
- **`@rolitt/email`**: é‚®ä»¶æ¨¡æ¿åŒ… - å¤šè¯­è¨€æ¨¡æ¿ã€è‡ªåŠ¨åŒ–å‘é€ã€æ¨¡æ¿ç®¡ç†
- **`@rolitt/shopify`**: Shopify é›†æˆåŒ… - è®¢å•åŒæ­¥ã€åº“å­˜ç®¡ç†ã€äº§å“åŒæ­¥
- **`@rolitt/admin`**: ç®¡ç†ç³»ç»ŸåŒ… - åå°ç®¡ç†ã€æ•°æ®ç›‘æ§ã€ç³»ç»Ÿé…ç½®
- **`@rolitt/shared`**: å…±äº«ç»„ä»¶åº“ - é€šç”¨ç»„ä»¶ã€å·¥å…·å‡½æ•°ã€ç±»å‹å®šä¹‰
- **`@rolitt/ai-core`**: AI æ ¸å¿ƒåŒ… - æ¨¡å‹ç®¡ç†ã€æ¨ç†å¼•æ“ã€æ•°æ®å¤„ç†

### **æ ¸å¿ƒæŠ€æœ¯æ ˆ**

#### **å‰ç«¯æŠ€æœ¯æ ˆ**
- **æ¡†æ¶**: Next.js 15.3.4 (App Router) + React 19.0.0
- **ç±»å‹ç³»ç»Ÿ**: TypeScript 5.0 (Strict Mode)
- **æ ·å¼ç³»ç»Ÿ**: Tailwind CSS 4 + shadcn/ui ç»„ä»¶åº“
- **åŠ¨ç”»**: Framer Motion + Lenis å¹³æ»‘æ»šåŠ¨
- **è¡¨å•éªŒè¯**: React Hook Form + Zod
- **å›½é™…åŒ–**: next-intl (4ç§è¯­è¨€æ”¯æŒ)

#### **åç«¯ä¸æ•°æ®åº“**
- **æ•°æ®åº“**: PostgreSQL (Supabase æ‰˜ç®¡) + Drizzle ORM
- **ç¼“å­˜ç³»ç»Ÿ**: Redis (Upstash) - æ™ºèƒ½ç¼“å­˜ç®¡ç†å’Œæ€§èƒ½ä¼˜åŒ–
- **èº«ä»½éªŒè¯**: Supabase Auth (ä¸»ç³»ç»Ÿ) + Firebase AuthåŒæ­¥ (å®¹ç¾å¤‡ä»½)
- **é‚®ä»¶ç³»ç»Ÿ**: å¤šè¯­è¨€ Supabase Auth é‚®ä»¶æ¨¡æ¿ + Resend é›†æˆ

#### **ç¬¬ä¸‰æ–¹é›†æˆ**
- **æ”¯ä»˜ç³»ç»Ÿ**: Stripe (Checkout + Webhooks + Subscriptions)
  - API ç‰ˆæœ¬ç»Ÿä¸€: `2025-06-30.basil`
  - æ”¯æŒè®¢é˜…ã€ä¸€æ¬¡æ€§æ”¯ä»˜ã€é€€æ¬¾å¤„ç†
- **ç”µå•†é›†æˆ**: Shopify Admin API + GraphQL + REST
- **è¥é”€æœåŠ¡**: Klaviyo API é›†æˆ - è‡ªåŠ¨åŒ–é‚®ä»¶è¥é”€
- **å†…å®¹ç®¡ç†**: Notion API + Notion Markdown æ”¯æŒ

#### **å¼€å‘ä¸éƒ¨ç½²**
- **ç›‘æ§**: Sentry é”™è¯¯è¿½è¸ª + PostHog åˆ†æ
- **æµ‹è¯•**: Playwright (E2E) + Vitest (å•å…ƒæµ‹è¯•)
- **éƒ¨ç½²**: Railway (ä¸»è¦) + Vercel + Cloudflare Workers æ”¯æŒ
- **åŒ…ç®¡ç†**: npm Workspaces + TypeScript Project References

### **æ”¯ä»˜ç³»ç»Ÿæ¶æ„**

**å¼‚æ­¥æ”¯ä»˜å¤„ç†æ¨¡å¼**ï¼š

# å®Œæ•´çš„å¼‚æ­¥æ”¯ä»˜å¤„ç†æ¨¡å¼

```mermaid
graph TD
    A["ğŸ§‘â€ğŸ’» ç”¨æˆ·å¡«å†™é¢„è®¢è¡¨å•<br/>(è§„æ ¼ + email)"] --> A1["ğŸ”’ è¡¨å•éªŒè¯ + é˜²é‡å¤æäº¤"]
    A1 --> B["âš¡ initiatePreorder()"]
    B --> B1["ğŸ” å¹‚ç­‰æ€§æ£€æŸ¥"]
    B1 --> C["ğŸ“ åˆ›å»ºé¢„è®¢è®°å½•<br/>(status: initiated)"]
    C --> D["ğŸš€ ç«‹å³è¿”å›é¢„è®¢ID"]
    D --> E["ğŸ’³ handleCheckout()"]
    E --> F["âš¡ åˆ›å»ºStripeä¼šè¯"]
    F --> G["ğŸ¯ ç«‹å³è·³è½¬åˆ°Stripe<br/>â±ï¸ ç›®æ ‡: < 300ms<br/>ğŸ“Š å®æ—¶ç›‘æ§"]

    %% å¼‚æ­¥å¹¶è¡Œå¤„ç† - ä¸‰ä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œ
    C --> H["ğŸ”„ processPreorderAsync()<br/>(å¼‚æ­¥é˜Ÿåˆ—ï¼Œä¸é˜»å¡)"]
    H --> H1["ğŸš€ å¯åŠ¨ä¸‰ä¸ªå¹¶è¡Œä»»åŠ¡"]

    %% å¹¶è¡Œä»»åŠ¡1ï¼šsupabaseç”¨æˆ·åˆ›å»º
    H1 --> I["ğŸ‘¤ åˆ›å»ºsupabaseç”¨æˆ·"]
    I --> I1{åˆ›å»ºæˆåŠŸ?}
    I1 -->|å¦| I2["ğŸ”„ é‡è¯•(æœ€å¤š3æ¬¡)"]
    I2 --> I3{é‡è¯•æˆåŠŸ?}
    I3 -->|å¦| I4["ğŸš¨ supabaseå¤±è´¥å‘Šè­¦"]

    %% å¹¶è¡Œä»»åŠ¡2ï¼šPostgreSQLåŒæ­¥
    H1 --> J["ğŸ”„ åŒæ­¥åˆ°PostgreSQL<br/>(usersè¡¨ + preordersè¡¨)"]
    J --> J1{åŒæ­¥æˆåŠŸ?}
    J1 -->|å¦| J2["ğŸ”„ é‡è¯•æœºåˆ¶"]
    J2 --> J3{é‡è¯•æˆåŠŸ?}
    J3 -->|å¦| J4["ğŸš¨ æ•°æ®åº“åŒæ­¥å¤±è´¥å‘Šè­¦"]

    %% å¹¶è¡Œä»»åŠ¡3ï¼šKlaviyoå¯åŠ¨äº‹ä»¶
    H1 --> K["ğŸ“§ å‘é€Klaviyoå¯åŠ¨äº‹ä»¶"]
    K --> K1{å‘é€æˆåŠŸ?}
    K1 -->|å¦| K2["ğŸ”„ é‡è¯•å‘é€"]
    K2 --> K3{é‡è¯•æˆåŠŸ?}
    K3 -->|å¦| K4["ğŸš¨ Klaviyoå¯åŠ¨äº‹ä»¶å¤±è´¥"]

    %% ä¸‰ä¸ªä»»åŠ¡å®Œæˆåæ›´æ–°çŠ¶æ€
    I1 -->|æ˜¯| L1["âœ… supabaseå®Œæˆ"]
    I3 -->|æ˜¯| L1
    J1 -->|æ˜¯| L2["âœ… PostgreSQLå®Œæˆ"]
    J3 -->|æ˜¯| L2
    K1 -->|æ˜¯| L3["âœ… Klaviyoå¯åŠ¨å®Œæˆ"]
    K3 -->|æ˜¯| L3

    L1 --> L["ğŸ“Š æ£€æŸ¥æ‰€æœ‰ä»»åŠ¡çŠ¶æ€"]
    L2 --> L
    L3 --> L
    L --> L4["ğŸ“Š æ›´æ–°çŠ¶æ€(processing)"]
    L4 --> L5["ğŸ“± å®æ—¶çŠ¶æ€æ¨é€ç»™ç”¨æˆ·"]

    %% æ”¯ä»˜æµç¨‹
    G --> M{ç”¨æˆ·æ”¯ä»˜ç»“æœ}
    M -->|æˆåŠŸ| N["ğŸ’° æ”¯ä»˜æˆåŠŸ"]
    M -->|å¤±è´¥| M1["âŒ æ”¯ä»˜å¤±è´¥"]
    M1 --> M2["ğŸ“§ æ”¾å¼ƒè´­ç‰©è½¦æŒ½å›é‚®ä»¶"]
    M1 --> M3["ğŸ”„ é‡æ–°å°è¯•æ”¯ä»˜å…¥å£"]

    %% Stripe Webhookå¤„ç†
    N --> N1["ğŸª Stripe Webhookè§¦å‘"]
    N1 --> N2["ğŸ” Webhookç­¾åéªŒè¯"]
    N2 --> N3{éªŒè¯é€šè¿‡?}
    N3 -->|å¦| N4["ğŸš¨ å®‰å…¨å‘Šè­¦"]
    N3 -->|æ˜¯| O["âœ… æ›´æ–°çŠ¶æ€(completed)"]

    %% Webhookå¯é æ€§ä¿éšœ
    N1 --> N5["â° Webhookè¶…æ—¶æ£€æµ‹"]
    N5 --> N6{è¶…æ—¶/å¤±è´¥?}
    N6 -->|æ˜¯| N7["ğŸ”„ Stripeäº‹ä»¶é‡æ”¾æœºåˆ¶"]
    N6 -->|å¦| O
    N7 --> O

    %% è®¢å•åŒæ­¥åˆ°Shopify - æ–°å¢æµç¨‹
    O --> R["ğŸ“¦ åŒæ­¥è®¢å•åˆ°Shopify"]
    R --> R1{åŒæ­¥æˆåŠŸ?}
    R1 -->|å¦| R2["ğŸ”„ ShopifyåŒæ­¥é‡è¯•<br/>(æœ€å¤š3æ¬¡)"]
    R2 --> R3{é‡è¯•æˆåŠŸ?}
    R3 -->|å¦| R4["ğŸš¨ ShopifyåŒæ­¥å¤±è´¥å‘Šè­¦"]
    R3 -->|æ˜¯| R5["âœ… Shopifyè®¢å•åˆ›å»ºå®Œæˆ"]
    R1 -->|æ˜¯| R5

    %% åº“å­˜å’Œå±¥çº¦æµç¨‹
    R5 --> S["ğŸ“‹ å¯åŠ¨å±¥çº¦æµç¨‹"]
    S --> S1["ğŸ“¦ åº“å­˜æ‰£å‡"]
    S1 --> S2["ğŸ·ï¸ ç”Ÿæˆå‘è´§æ ‡ç­¾"]
    S2 --> S3["ğŸ“± å‘è´§é€šçŸ¥ç”¨æˆ·"]
    S3 --> S4["ğŸšš ç‰©æµè¿½è¸ªå¯åŠ¨"]

    %% KlaviyoæˆåŠŸäº‹ä»¶ï¼ˆé€šè¿‡Stripe Webhookï¼‰
    O --> P["ğŸ‰ å‘é€KlaviyoæˆåŠŸäº‹ä»¶"]
    P --> P1["ğŸ”” ç”¨æˆ·è´­ä¹°æˆåŠŸé€šçŸ¥"]
    P1 --> P2["ğŸ“Š è½¬åŒ–æ¼æ–—æ•°æ®ç»Ÿè®¡"]

    %% å®Œæ•´æµç¨‹çŠ¶æ€æ›´æ–°
    R5 --> Q["ğŸ” å®šæœŸå¯¹è´¦æœºåˆ¶<br/>(Stripe â†” PostgreSQL â†” Supabase â†” Firebase â†” Shopify)"]
    Q --> Q1{æ•°æ®ä¸€è‡´æ€§?}
    Q1 -->|ä¸ä¸€è‡´| Q2["ğŸš¨ æ•°æ®ä¿®å¤ + äººå·¥å¹²é¢„"]
    Q1 -->|ä¸€è‡´| Q3["âœ… ç³»ç»Ÿå¥åº·çŠ¶æ€"]

    %% å®Œæ•´æµç¨‹çŠ¶æ€æ›´æ–°
    S4 --> T["ğŸ“ˆ æ›´æ–°æœ€ç»ˆçŠ¶æ€(fulfilled)"]
    T --> T1["ğŸ“§ å®Œæˆç¡®è®¤é‚®ä»¶"]
    T1 --> T2["â­ ç”¨æˆ·è¯„ä»·é‚€è¯·"]

    %% æ ·å¼å®šä¹‰
    style A fill:#e1f5fe
    style G fill:#c8e6c9
    style N fill:#ffecb3
    style H1 fill:#f3e5f5
    style O fill:#e8f5e8
    style R5 fill:#e8f5e8
    style S fill:#e3f2fd
    style T fill:#f1f8e9
    style I4 fill:#ffcdd2
    style J4 fill:#ffcdd2
    style K4 fill:#ffcdd2
    style N4 fill:#ffcdd2
    style R4 fill:#ffcdd2
    style Q2 fill:#ffcdd2

    classDef parallel fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,stroke-dasharray: 5 5
    classDef errorHandling fill:#ffcdd2,stroke:#d32f2f,stroke-width:2px
    classDef monitoring fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef fulfillment fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef completion fill:#f1f8e9,stroke:#388e3c,stroke-width:2px

    class I,J,K,L1,L2,L3 parallel
    class I2,I4,J2,J4,K2,K4,N7,R2,R4,Q2 errorHandling
    class G,L5,P2,Q monitoring
    class R,R5,S,S1,S2,S3,S4 fulfillment
    class T,T1,T2,Q3 completion
```

##ğŸ”§ æ ¸å¿ƒè®¾è®¡ä¼˜åŠ¿ï¼š

  1. æ”¯ä»˜é©±åŠ¨çš„ç”¨æˆ·åˆ›å»º

  - é«˜è´¨é‡ç”¨æˆ·æ± : åªæœ‰å®Œæˆæ”¯ä»˜çš„ç”¨æˆ·æ‰åˆ›å»ºè®¤è¯è´¦æˆ·
  - è¥é”€ç²¾å‡†åº¦: åŸºäºçœŸå®è´­ä¹°è¡Œä¸ºï¼Œä¸æ˜¯è™šå‡æ³¨å†Œ
  - è½¬åŒ–ç‡ä¼˜åŒ–: å»é™¤æ³¨å†Œæ‘©æ“¦ï¼Œç›´æ¥æ”¯ä»˜

  2. å¤šå±‚å®¹ç¾æ¶æ„

  - ä¸»æ•°æ®åº“: PostgreSQL (Supabase æ‰˜ç®¡)
  - ä¸»è®¤è¯: Supabase Auth (Web ç«¯)
  - å¤‡ä»½è®¤è¯: Firebase Auth (Flutter + å®¹ç¾)
  - æ•°æ®åŒæ­¥: åŒå‘åŒæ­¥ä¿è¯ä¸€è‡´æ€§

  3. å¹³å°ç‰¹åŒ–è®¤è¯

  // Web ç«¯ï¼šSupabase Auth (ä¸»è®¤è¯ç³»ç»Ÿ)
  const supabaseResult = await supabaseAuth.signUp(email, tempPassword);

  // ç§»åŠ¨ç«¯ï¼šFirebase Auth (å®¹ç¾å¤‡ä»½ + Flutter åŸç”Ÿæ”¯æŒ)
  const firebaseResult = await syncUserToFirebase(email);

  // æ•°æ®åº“ï¼šç»Ÿä¸€ç”¨æˆ·è¡¨
  {
    supabaseId: "supabase_user_id",     // Web ä¸»è®¤è¯ ID
    firebaseUid: "firebase_user_uid",   // Flutter è®¤è¯ ID
    authSource: "supabase",             // ä¸»è®¤è¯æ¥æº
    email: "user@example.com",          // æ ¸å¿ƒç»Ÿä¸€æ ‡è¯†ç¬¦
  }

  4. å¼‚æ­¥éé˜»å¡å¤„ç†

  - æ”¯ä»˜å“åº”: < 300ms ç«‹å³å“åº”
  - ç”¨æˆ·åˆ›å»º: Stripe Webhook å¼‚æ­¥å¤„ç†
  - è®¤è¯åŒæ­¥: å¹¶è¡Œå¤„ç†ï¼Œäº’ä¸é˜»å¡

  ğŸš€ è¿™ä¸ªæ¶æ„çš„å•†ä¸šä»·å€¼ï¼š

  1. é«˜è½¬åŒ–ç‡: æ”¯ä»˜ä¼˜å…ˆï¼Œå‡å°‘æ³¨å†Œæ‘©æ“¦
  2. ç²¾å‡†è¥é”€: åªå¯¹çœŸå®ä¹°å®¶è¿›è¡Œè¥é”€æŠ•å…¥
  3. å¤šå¹³å°æ”¯æŒ: Web + Flutter æ— ç¼åˆ‡æ¢
  4. å®¹ç¾èƒ½åŠ›: åŒè®¤è¯ç³»ç»Ÿï¼ŒæœåŠ¡é«˜å¯ç”¨
  5. æ•°æ®ä¸€è‡´æ€§: ç»Ÿä¸€æ•°æ®åº“ï¼Œå¤šå¹³å°åŒæ­¥

  è¿™æ˜¯ä¸€ä¸ªéå¸¸å…ˆè¿›çš„ç”µå•†è®¤è¯æ¶æ„ï¼ğŸ¯
## ä¸»è¦ç‰¹ç‚¹

### 1. æ–°å¢ Shopify è®¢å•åŒæ­¥æµç¨‹
- **è®¢å•åˆ›å»º**ï¼šæ”¯ä»˜æˆåŠŸåç«‹å³åŒæ­¥åˆ° Shopify
- **é‡è¯•æœºåˆ¶**ï¼šShopify åŒæ­¥å¤±è´¥æ—¶çš„é‡è¯•é€»è¾‘
- **é”™è¯¯å¤„ç†**ï¼šåŒæ­¥å¤±è´¥çš„å‘Šè­¦å’Œäººå·¥å¹²é¢„

### 2. å®Œæ•´çš„å±¥çº¦æµç¨‹
- **åº“å­˜ç®¡ç†**ï¼šè‡ªåŠ¨æ‰£å‡åº“å­˜
- **å‘è´§æµç¨‹**ï¼šç”Ÿæˆå‘è´§æ ‡ç­¾å’Œç‰©æµè¿½è¸ª
- **ç”¨æˆ·é€šçŸ¥**ï¼šå‘è´§ç¡®è®¤å’Œè¿½è¸ªä¿¡æ¯

### **3. å¢å¼ºçš„æ•°æ®ä¸€è‡´æ€§ç›‘æ§
- **å¤šç³»ç»Ÿå¯¹è´¦**ï¼šStripe â†” PostgreSQL â†” Supabase â†” Firebase â†” Shopify
- **å®æ—¶ç›‘æ§**ï¼šç¡®ä¿æ‰€æœ‰ç³»ç»Ÿæ•°æ®åŒæ­¥ä¸€è‡´

### 4. å®Œæ•´çš„çŠ¶æ€ç®¡ç†
- `initiated` â†’ `processing` â†’ `completed` â†’ `fulfilled`
- æ¯ä¸ªçŠ¶æ€å¯¹åº”æ˜ç¡®çš„ä¸šåŠ¡å«ä¹‰å’Œåç»­æ“ä½œ

### 5. ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- **å®æ—¶çŠ¶æ€æ¨é€**ï¼šç”¨æˆ·å¯ä»¥å®æ—¶äº†è§£è®¢å•è¿›å±•
- **å®Œæˆç¡®è®¤**ï¼šå‘è´§åçš„ç¡®è®¤é‚®ä»¶å’Œè¯„ä»·é‚€è¯·
- **å¼‚å¸¸å¤„ç†**ï¼šæ”¯ä»˜å¤±è´¥åçš„æŒ½å›æœºåˆ¶

è¿™ä¸ªå®Œæ•´ç‰ˆæœ¬è¦†ç›–äº†ä»ç”¨æˆ·ä¸‹å•åˆ°å•†å“å‘è´§çš„æ•´ä¸ªä¸šåŠ¡é—­ç¯ï¼Œç¡®ä¿äº†ç³»ç»Ÿçš„å¯é æ€§å’Œç”¨æˆ·ä½“éªŒã€‚
### **é¡¹ç›®ç»“æ„**

```
src/
â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”œâ”€â”€ [locale]/          # å›½é™…åŒ–è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ (marketing)/   # è¥é”€é¡µé¢ç»„
â”‚   â”‚   â”œâ”€â”€ (auth)/        # è®¤è¯é¡µé¢ç»„
â”‚   â”‚   â””â”€â”€ admin/         # ç®¡ç†åå°
â”‚   â”œâ”€â”€ actions/           # Server Actions
â”‚   â”‚   â”œâ”€â”€ checkoutActions.ts    # æ”¯ä»˜å¤„ç†
â”‚   â”‚   â”œâ”€â”€ productActions.ts     # äº§å“ç®¡ç†
â”‚   â”‚   â””â”€â”€ userActions.ts        # ç”¨æˆ·ç®¡ç†
â”‚   â””â”€â”€ api/               # API è·¯ç”±
â”‚       â”œâ”€â”€ webhooks/      # Webhook å¤„ç†
â”‚       â”œâ”€â”€ products/      # äº§å“ API
â”‚       â””â”€â”€ contact/       # è”ç³»è¡¨å•
â”œâ”€â”€ components/            # UI ç»„ä»¶
â”‚   â”œâ”€â”€ ui/               # åŸºç¡€ç»„ä»¶ (shadcn/ui)
â”‚   â”œâ”€â”€ analytics/        # åˆ†æå·¥å…·ç»„ä»¶
â”‚   â”œâ”€â”€ auth/             # è®¤è¯ç»„ä»¶
â”‚   â”œâ”€â”€ payments/         # æ”¯ä»˜ç»„ä»¶
â”‚   â””â”€â”€ pre-order/        # é¢„è®¢ç»„ä»¶
â”œâ”€â”€ libs/                 # æ ¸å¿ƒåº“
â”‚   â”œâ”€â”€ supabase/         # Supabase é…ç½® (ä¸»è®¤è¯ç³»ç»Ÿ)
â”‚   â”œâ”€â”€ firebase/         # Firebase é…ç½® (å®¹ç¾å¤‡ä»½)
â”‚   â”œâ”€â”€ payments/         # æ”¯ä»˜ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ core/         # æ ¸å¿ƒç±»å‹å’ŒæœåŠ¡
â”‚   â”‚   â””â”€â”€ providers/    # æ”¯ä»˜æä¾›å•†
â”‚   â”œâ”€â”€ DB.ts            # æ•°æ®åº“è¿æ¥
â”‚   â”œâ”€â”€ Env.ts           # ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ Klaviyo.ts       # è¥é”€é›†æˆ
â”‚   â””â”€â”€ webhook-logger.ts # æ—¥å¿—ç³»ç»Ÿ
â”œâ”€â”€ models/               # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ Schema.ts        # Drizzle æ•°æ®åº“æ¨¡å¼
â”œâ”€â”€ packages/             # è§£è€¦åŒ…æ¶æ„ (Monorepo Workspaces)
â”‚   â”œâ”€â”€ admin/           # Admin ç®¡ç†ç³»ç»ŸåŒ…
â”‚   â”‚   â”œâ”€â”€ src/         # Admin æºä»£ç 
â”‚   â”‚   â”‚   â”œâ”€â”€ features/ # åŠŸèƒ½æ¨¡å— (users, orders, webhooks, scripts)
â”‚   â”‚   â”‚   â”œâ”€â”€ components/ # UI ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ stores/  # Zustand çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ types/   # TypeScript ç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ package.json # ç‹¬ç«‹ä¾èµ–ç®¡ç†
â”‚   â”œâ”€â”€ shopify/         # Shopify é›†æˆåŒ… âœ¨
â”‚   â”‚   â”œâ”€â”€ src/         # Shopify é›†æˆæ ¸å¿ƒä»£ç 
â”‚   â”‚   â”‚   â”œâ”€â”€ config/  # é…ç½®ç®¡ç†å’ŒåŠŸèƒ½å¼€å…³
â”‚   â”‚   â”‚   â”œâ”€â”€ core/    # æ ¸å¿ƒåŠŸèƒ½ (client, error-handler, rate-limiter)
â”‚   â”‚   â”‚   â”œâ”€â”€ services/ # ä¸šåŠ¡æœåŠ¡ (products, orders, inventory, customers)
â”‚   â”‚   â”‚   â”œâ”€â”€ webhooks/ # Webhook å¤„ç†å’ŒéªŒè¯
â”‚   â”‚   â”‚   â”œâ”€â”€ monitoring/ # ç›‘æ§å’Œå¥åº·æ£€æŸ¥
â”‚   â”‚   â”‚   â””â”€â”€ integration/ # Next.js é›†æˆæ”¯æŒ
â”‚   â”‚   â””â”€â”€ package.json # Shopify åŒ…ä¾èµ–
â”‚   â”œâ”€â”€ payments/        # æ”¯ä»˜ç³»ç»ŸåŒ… âœ¨
â”‚   â”‚   â”œâ”€â”€ src/         # æ”¯ä»˜æ ¸å¿ƒä»£ç 
â”‚   â”‚   â”‚   â”œâ”€â”€ features/ # æ”¯ä»˜åŠŸèƒ½ (stripe, webhooks)
â”‚   â”‚   â”‚   â”œâ”€â”€ components/ # æ”¯ä»˜ UI ç»„ä»¶ (CheckoutForm)
â”‚   â”‚   â”‚   â”œâ”€â”€ libs/    # æ ¸å¿ƒåº“å’Œé”™è¯¯å¤„ç†
â”‚   â”‚   â”‚   â””â”€â”€ types/   # æ”¯ä»˜ç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ package.json # æ”¯ä»˜åŒ…ä¾èµ–
â”‚   â”œâ”€â”€ email/           # å¤šè¯­è¨€é‚®ä»¶æ¨¡æ¿åŒ… âœ¨
â”‚   â”‚   â”œâ”€â”€ src/         # é‚®ä»¶æ¨¡æ¿æºä»£ç 
â”‚   â”‚   â”‚   â”œâ”€â”€ templates/ # 6ç§é‚®ä»¶ç±»å‹æ¨¡æ¿ (invite, confirmation, recovery, etc.)
â”‚   â”‚   â”‚   â”œâ”€â”€ config.ts  # é‚®ä»¶é…ç½®å’Œå“ç‰Œå®šåˆ¶
â”‚   â”‚   â”‚   â”œâ”€â”€ utils.ts   # é‚®ä»¶å·¥å…·å‡½æ•°å’ŒéªŒè¯
â”‚   â”‚   â”‚   â””â”€â”€ supabase-integration.ts # Supabase Auth é›†æˆ
â”‚   â”‚   â””â”€â”€ package.json # é‚®ä»¶åŒ…ä¾èµ–
â”‚   â”œâ”€â”€ referral/        # æ¨èç³»ç»ŸåŒ… âœ¨
â”‚   â”‚   â”œâ”€â”€ src/         # æ¨èç³»ç»Ÿæ ¸å¿ƒä»£ç 
â”‚   â”‚   â”‚   â”œâ”€â”€ mvp.ts   # æ ¸å¿ƒ3å‡½æ•° (generateLink, setCookieHeader, calculateReward)
â”‚   â”‚   â”‚   â”œâ”€â”€ admin/   # ç®¡ç†é¢æ¿ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ components/ # ç”¨æˆ·æ¨èç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ tracking.ts # æ¨èè¿½è¸ªå’Œåˆ†æ
â”‚   â”‚   â””â”€â”€ package.json # æ¨èåŒ…ä¾èµ–
â”‚   â”œâ”€â”€ image-upload/    # å›¾ç‰‡ä¸Šä¼ åŒ… âœ¨
â”‚   â”‚   â”œâ”€â”€ src/         # å›¾ç‰‡ä¸Šä¼ æ ¸å¿ƒä»£ç 
â”‚   â”‚   â”‚   â”œâ”€â”€ client.ts # Cloudflare R2 å®¢æˆ·ç«¯
â”‚   â”‚   â”‚   â”œâ”€â”€ hooks/   # React Hooks (useImageUpload)
â”‚   â”‚   â”‚   â”œâ”€â”€ validator.ts # ä¸‰å±‚å®‰å…¨éªŒè¯
â”‚   â”‚   â”‚   â””â”€â”€ types.ts # ä¸Šä¼ ç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ package.json # å›¾ç‰‡ä¸Šä¼ åŒ…ä¾èµ–
â”‚   â”œâ”€â”€ auth/            # è®¤è¯ç³»ç»ŸåŒ…
â”‚   â”‚   â”œâ”€â”€ src/         # è®¤è¯æ ¸å¿ƒä»£ç 
â”‚   â”‚   â”‚   â”œâ”€â”€ providers/ # è®¤è¯æä¾›å•† (Supabase, Firebase)
â”‚   â”‚   â”‚   â”œâ”€â”€ components/ # è®¤è¯ UI ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ features/ # è®¤è¯åŠŸèƒ½æ¨¡å—
â”‚   â”‚   â””â”€â”€ package.json # è®¤è¯åŒ…ä¾èµ–
â”‚   â””â”€â”€ shared/          # å…±äº«ç»„ä»¶å’Œå·¥å…·åŒ…
â”‚       â”œâ”€â”€ src/         # å…±äº«ä»£ç 
â”‚       â”‚   â”œâ”€â”€ ui/      # é€šç”¨ UI ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ utils/   # å·¥å…·å‡½æ•°
â”‚       â”‚   â”œâ”€â”€ types/   # å…±äº«ç±»å‹å®šä¹‰
â”‚       â”‚   â””â”€â”€ hooks/   # é€šç”¨ React Hooks
â”‚       â””â”€â”€ package.json # å…±äº«åŒ…ä¾èµ–
â”œâ”€â”€ locales/              # å›½é™…åŒ–æ–‡ä»¶
â”œâ”€â”€ styles/               # å…¨å±€æ ·å¼
â”œâ”€â”€ utils/                # å·¥å…·å‡½æ•°
â””â”€â”€ validations/          # è¡¨å•éªŒè¯
```

## **ğŸš€ é‡å¤§å¼€å‘è¿›å±•**

### **1. PostgreSQL ä¸»æ•°æ®åº“æ¶æ„é‡æ„**

- **æ ¸å¿ƒæ”¹è¿›**: å°† PostgreSQL è®¾ç½®ä¸ºç‹¬ç«‹çš„ä¸»æ•°æ®åº“ï¼Œè§£å†³äº†ä¹‹å‰ PostgreSQL ä¾èµ– Firebase åˆå§‹åŒ–çš„é—®é¢˜ã€‚
- **æ•°æ®æµä¼˜åŒ–**: ç”¨æˆ·æ•°æ®æµä»¥ PostgreSQL ä¸ºä¸­å¿ƒï¼ŒFirebase æˆä¸ºå¯é€‰çš„åŒæ­¥ç›®æ ‡ï¼Œæå‡äº†æ•°æ®ä¸€è‡´æ€§å’Œç³»ç»Ÿè§£è€¦æ€§ã€‚
- **ä¸šåŠ¡ä»·å€¼**: æ˜¾è‘—æå‡äº†æ•°æ®åº“çš„ç¨³å®šæ€§å’Œå¯æ‰©å±•æ€§ï¼Œé™ä½äº†ç³»ç»Ÿå¤æ‚æ€§ï¼Œä¸ºåç»­åŠŸèƒ½è¿­ä»£å¥ å®šäº†åšå®åŸºç¡€ã€‚

### **2. æ··åˆè¥é”€æ¨¡å¼å®ç°**

- **æ ¸å¿ƒæ”¹è¿›**: é‡æ„äº†é¢„è®¢æµç¨‹å’Œ Stripe Webhookï¼Œå®ç°äº†åªæœ‰å®Œæˆæ”¯ä»˜çš„ç”¨æˆ·æ‰åˆ›å»ºè´¦æˆ·çš„é€»è¾‘ã€‚
- **ç²¾å‡†è¥é”€**: é€šè¿‡æ›´ç²¾å‡†çš„ç”¨æˆ·å®šä¹‰å’Œè½¬åŒ–æ¼æ–—ï¼Œä¼˜åŒ–äº†è¥é”€ç­–ç•¥ï¼Œæé«˜äº†ç”¨æˆ·è½¬åŒ–ç‡ã€‚
- **ä¸šåŠ¡ä»·å€¼**: æå‡äº†è¥é”€æ´»åŠ¨çš„æŠ•èµ„å›æŠ¥ç‡ (ROI)ï¼Œå‡å°‘äº†æ— æ•ˆç”¨æˆ·æ•°æ®çš„ç§¯ç´¯ï¼Œä½¿èµ„æºåˆ†é…æ›´é«˜æ•ˆã€‚

### **3. Firebase â†’ Supabase è®¤è¯ç³»ç»Ÿè¿ç§»**

- **æ ¸å¿ƒæ”¹è¿›**: å®Œæˆäº†ä» Firebase Auth åˆ° Supabase Auth çš„ä¸»è®¤è¯ç³»ç»Ÿè¿ç§»ï¼Œç¯å¢ƒå˜é‡ä» 6 ä¸ªå‡å°‘åˆ° 2 ä¸ªï¼ˆ67% å‡å°‘ï¼‰ã€‚
- **æŠ€æœ¯å®ç°**: é‡å†™äº† AuthContextã€ä¸­é—´ä»¶å’Œ API è·¯ç”±ï¼Œå®ç°äº†å‘åå…¼å®¹æ€§ï¼Œä¿æŒ Firebase ä½œä¸ºå®¹ç¾å¤‡ä»½å’Œ Flutter æ”¯æŒã€‚
- **ä¸šåŠ¡ä»·å€¼**: æ˜¾è‘—æå‡äº†å¼€å‘æ•ˆç‡ï¼Œè§£å†³äº† Railway æ„å»ºä¸ç¨³å®šé—®é¢˜ï¼Œä¸ºå¤šå¹³å°æ”¯æŒå¥ å®šåŸºç¡€ã€‚

### **4. Admin åŒ…è§£è€¦æ¶æ„å®ç°**

- **æ ¸å¿ƒæ”¹è¿›**: åˆ›å»ºäº†ç‹¬ç«‹çš„ `packages/admin` è§£è€¦åŒ…ï¼Œå®ç°äº†é›¶æŠ€æœ¯åˆ†è£‚ã€é›¶åŠŸèƒ½å›å½’ã€é›¶å­¦ä¹ æˆæœ¬çš„æ¨¡å—åŒ–æ¶æ„ã€‚
- **æŠ€æœ¯å®ç°**: é‡‡ç”¨ Zustand è½»é‡çº§çŠ¶æ€ç®¡ç†ï¼ŒæŒ‰åŠŸèƒ½ç»„ç»‡ä»£ç ç»“æ„ï¼Œå»ºç«‹äº†å®Œæ•´çš„åŒ…é—´é€šä¿¡æœºåˆ¶ã€‚
- **ä¸šåŠ¡ä»·å€¼**: æå‡äº†ä»£ç å¯ç»´æŠ¤æ€§ï¼Œæ”¯æŒå¹¶è¡Œå¼€å‘ï¼Œä¸ºåç»­åŠŸèƒ½æ¨¡å—åŒ–å¥ å®šäº†åŸºç¡€ã€‚

### **5. Shopify é›†æˆåŒ…å®Œæ•´å®ç°**

- **æ ¸å¿ƒæ”¹è¿›**: å®Œæˆäº†ç‹¬ç«‹çš„ `@rolitt/shopify` é›†æˆåŒ…å¼€å‘ï¼Œå®ç°äº†å®Œæ•´çš„è®¢å•åŒæ­¥ã€äº§å“ç®¡ç†å’Œåº“å­˜æ§åˆ¶åŠŸèƒ½ã€‚
- **æŠ€æœ¯å®ç°**: é‡‡ç”¨æ’ä»¶åŒ–è®¾è®¡å’Œå•å‘æ•°æ®æµæ¶æ„ï¼Œæ”¯æŒ Shopify Admin API + GraphQL + RESTï¼Œæä¾›å¥åº·æ£€æŸ¥å’Œç›‘æ§åŠŸèƒ½ã€‚
- **ä¸šåŠ¡ä»·å€¼**: åˆ©ç”¨ Shopify æˆç†Ÿçš„å±¥çº¦èƒ½åŠ›ï¼ŒåŒæ—¶ä¿æŒæ•°æ®ä¸»æƒï¼Œä¸ºç”µå•†ä¸šåŠ¡æ‰©å±•å¥ å®šåŸºç¡€ã€‚

### **6. å¤šè¯­è¨€é‚®ä»¶æ¨¡æ¿ç³»ç»Ÿå®ç°**

- **æ ¸å¿ƒæ”¹è¿›**: å®Œæˆäº†ä¼ä¸šçº§çš„ `@rolitt/email` å¤šè¯­è¨€é‚®ä»¶æ¨¡æ¿åŒ…ï¼Œæ”¯æŒ6ç§é‚®ä»¶ç±»å‹å’Œ3ç§è¯­è¨€ã€‚
- **æŠ€æœ¯å®ç°**: æä¾›å®Œæ•´çš„ Supabase Auth é‚®ä»¶æ¨¡æ¿é›†æˆï¼ŒåŒ…æ‹¬é‚€è¯·ã€ç¡®è®¤ã€é‡ç½®å¯†ç ã€é­”æ³•é“¾æ¥ã€é‚®ç®±å˜æ›´å’Œé‡æ–°è®¤è¯ã€‚
- **ä¸šåŠ¡ä»·å€¼**: æå‡ç”¨æˆ·ä½“éªŒå’Œå“ç‰Œä¸€è‡´æ€§ï¼Œæ”¯æŒå›½é™…åŒ–ä¸šåŠ¡æ‰©å±•ï¼Œå‡å°‘é‚®ä»¶æ¨¡æ¿ç»´æŠ¤æˆæœ¬ã€‚

### **7. æ”¯ä»˜ç³»ç»ŸåŒ…åŒ–æ¶æ„å®ç°** âœ¨

- **æ ¸å¿ƒæ”¹è¿›**: å®Œæˆäº†ç‹¬ç«‹çš„ `@rolitt/payments` æ”¯ä»˜ç³»ç»ŸåŒ…ï¼Œå®ç°äº†å®Œæ•´çš„ Stripe é›†æˆã€Webhook å¤„ç†å’Œæ”¯ä»˜ UI ç»„ä»¶ã€‚
- **æŠ€æœ¯å®ç°**: é‡‡ç”¨è§£è€¦æ¶æ„è®¾è®¡ï¼Œæ”¯æŒå¤šæ”¯ä»˜æä¾›å•†æ‰©å±•ï¼Œæä¾›ç±»å‹å®‰å…¨çš„æ”¯ä»˜æ“ä½œå’Œå®Œæ•´çš„é”™è¯¯å¤„ç†æœºåˆ¶ã€‚
- **ä¸šåŠ¡ä»·å€¼**: æå‡æ”¯ä»˜å®‰å…¨æ€§å’Œå¼€å‘æ•ˆç‡ï¼Œæ”¯æŒå¿«é€Ÿé›†æˆæ–°çš„æ”¯ä»˜æ–¹å¼ï¼Œä¸ºç”µå•†ä¸šåŠ¡æ‰©å±•æä¾›åšå®åŸºç¡€ã€‚

### **8. æ¨èç³»ç»ŸåŒ…å®ç°** âœ¨

- **æ ¸å¿ƒæ”¹è¿›**: å¼€å‘äº†æç®€çš„ `@rolitt/referral` æ¨èç³»ç»ŸåŒ…ï¼Œéµå¾ªå¥¥å¡å§†å‰ƒåˆ€åŸåˆ™ï¼Œä»…3ä¸ªæ ¸å¿ƒå‡½æ•°å®ç°å®Œæ•´æ¨èåŠŸèƒ½ã€‚
- **æŠ€æœ¯å®ç°**: é›¶ä¾èµ–è®¾è®¡ï¼Œå®Œå…¨å¯é€‰å¯ç”¨/ç¦ç”¨ï¼Œç®¡ç†å‘˜å¯é€šè¿‡åå°é…ç½®æ‰€æœ‰å‚æ•°ï¼Œæ”¯æŒç¤¾äº¤åˆ†äº«å’Œç§»åŠ¨ç«¯ä¼˜åŒ–ã€‚
- **ä¸šåŠ¡ä»·å€¼**: æå‡ç”¨æˆ·è·å®¢æ•ˆç‡ï¼Œé™ä½è¥é”€æˆæœ¬ï¼Œé€šè¿‡æ¨èå¥–åŠ±æœºåˆ¶å¢åŠ ç”¨æˆ·ç²˜æ€§å’Œè½¬åŒ–ç‡ã€‚

### **9. å›¾ç‰‡ä¸Šä¼ ç³»ç»ŸåŒ…å®ç°** âœ¨

- **æ ¸å¿ƒæ”¹è¿›**: æ„å»ºäº†å®‰å…¨çš„ `@rolitt/image-upload` å›¾ç‰‡ä¸Šä¼ åŒ…ï¼ŒåŸºäº Cloudflare R2 å­˜å‚¨ï¼Œä¸º ChatGPT å›¾ç‰‡è¯†åˆ«åŠŸèƒ½æä¾›åŸºç¡€æ”¯æŒã€‚
- **æŠ€æœ¯å®ç°**: ä¸‰å±‚å®‰å…¨éªŒè¯ï¼ˆæ–‡ä»¶ç±»å‹ç™½åå•ã€å¤§å°é™åˆ¶ã€æ–‡ä»¶å¤´é­”æ•°ï¼‰ï¼Œé¢„ç­¾å URL æ¨¡å¼ï¼ŒReact Hooks æ”¯æŒã€‚
- **ä¸šåŠ¡ä»·å€¼**: ä¸º AI åŠŸèƒ½æ‰©å±•å¥ å®šåŸºç¡€ï¼Œæå‡ç”¨æˆ·äº¤äº’ä½“éªŒï¼Œç¡®ä¿å›¾ç‰‡ä¸Šä¼ çš„å®‰å…¨æ€§å’Œå¯é æ€§ã€‚

### **10. Workspace åŒ…ç®¡ç†æ¶æ„å‡çº§** âœ¨

- **æ ¸å¿ƒæ”¹è¿›**: å®ç°äº†å®Œæ•´çš„ Monorepo æ¶æ„ï¼ŒåŒ…å« 8 ä¸ªç‹¬ç«‹åŠŸèƒ½åŒ…ï¼š`@rolitt/admin`ã€`@rolitt/shopify`ã€`@rolitt/payments`ã€`@rolitt/email`ã€`@rolitt/referral`ã€`@rolitt/image-upload`ã€`@rolitt/auth` å’Œ `@rolitt/shared`ã€‚
- **æŠ€æœ¯å®ç°**: æ›´æ–° next.config.ts æ”¯æŒ workspace åŒ…è§£æï¼Œç»Ÿä¸€çš„æ„å»ºå’Œæµ‹è¯•æµç¨‹ï¼Œç±»å‹å®‰å…¨çš„åŒ…é—´é€šä¿¡ï¼Œç‹¬ç«‹çš„ç‰ˆæœ¬ç®¡ç†ã€‚
- **ä¸šåŠ¡ä»·å€¼**: æ˜¾è‘—æå‡ä»£ç å¯ç»´æŠ¤æ€§ï¼Œæ”¯æŒå¹¶è¡Œå¼€å‘ï¼Œä¸ºåŠŸèƒ½æ¨¡å—åŒ–å’Œå›¢é˜Ÿåä½œå¥ å®šåŸºç¡€ï¼Œé™ä½ç³»ç»Ÿå¤æ‚æ€§ã€‚

## **ğŸ“ˆ ä¸šåŠ¡ä»·å€¼æ€»ç»“**

è¿™äº›é‡å¤§æ”¹è¿›ä¸º Rolitt AI ä¼´ä¾£äº§å“å¸¦æ¥äº†æ˜¾è‘—çš„ä¸šåŠ¡ä»·å€¼ï¼š

### **ğŸ—ï¸ ç³»ç»Ÿæ¶æ„ä¼˜åŠ¿**
- **ç³»ç»Ÿç¨³å®šæ€§æå‡**: é€šè¿‡è®¤è¯ç³»ç»Ÿè¿ç§»å’Œæ¨¡å—åŒ–æ¶æ„ï¼Œç³»ç»Ÿè¿è¡Œæ›´åŠ ç¨³å®šå¯é 
- **å¼€å‘æ•ˆç‡æå‡**: ç¯å¢ƒå˜é‡å‡å°‘ 67%ï¼Œ8ä¸ªç‹¬ç«‹åŒ…æ”¯æŒå¹¶è¡Œå¼€å‘ï¼Œæ˜¾è‘—æå‡å¼€å‘å’Œéƒ¨ç½²æ•ˆç‡
- **æ¶æ„å¯æ‰©å±•æ€§**: åŒ…è§£è€¦æ¶æ„å’ŒåŒè®¤è¯ç³»ç»Ÿï¼Œä¸ºå¤šå¹³å°æ‰©å±•å¥ å®šåŸºç¡€
- **å®¹ç¾èƒ½åŠ›å¢å¼º**: åŒè®¤è¯ç³»ç»Ÿå’Œå¤šç³»ç»Ÿå¯¹è´¦ï¼Œç¡®ä¿æœåŠ¡é«˜å¯ç”¨æ€§

### **ğŸ’° å•†ä¸šè¿è¥ä¼˜åŠ¿**
- **è¥é”€ç²¾å‡†åº¦æé«˜**: æ··åˆè¥é”€æ¨¡å¼å’Œæ¨èç³»ç»Ÿï¼Œå®ç°æ›´ç²¾å‡†çš„ç”¨æˆ·è§¦è¾¾å’Œè·å®¢
- **æ”¯ä»˜å®‰å…¨æ€§æå‡**: ç‹¬ç«‹æ”¯ä»˜åŒ…å’Œå®Œæ•´é”™è¯¯å¤„ç†ï¼Œä¿éšœäº¤æ˜“å®‰å…¨å’Œç”¨æˆ·ä¿¡ä»»
- **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**: å¤šè¯­è¨€é‚®ä»¶æ¨¡æ¿ã€å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½ï¼Œæå‡ç”¨æˆ·äº¤äº’ä½“éªŒ
- **è¿è¥æˆæœ¬é™ä½**: Shopify é›†æˆåˆ©ç”¨æˆç†Ÿå±¥çº¦èƒ½åŠ›ï¼Œé™ä½è¿è¥å¤æ‚æ€§

### **ğŸ”§ æŠ€æœ¯åˆ›æ–°ä¼˜åŠ¿**
- **æ•°æ®ä¸»æƒä¿æŠ¤**: ä»¥è‡ªæœ‰ç³»ç»Ÿä¸ºæ ¸å¿ƒï¼Œåˆ©ç”¨ç¬¬ä¸‰æ–¹æœåŠ¡èƒ½åŠ›çš„åŒæ—¶ä¿æŒæ•°æ®æ§åˆ¶æƒ
- **AI åŠŸèƒ½å°±ç»ª**: å›¾ç‰‡ä¸Šä¼ ç³»ç»Ÿä¸º ChatGPT é›†æˆå’Œ AI åŠŸèƒ½æ‰©å±•å¥ å®šåŸºç¡€
- **æ¨¡å—åŒ–è®¾è®¡**: 8ä¸ªåŠŸèƒ½åŒ…ç‹¬ç«‹å¼€å‘ã€æµ‹è¯•ã€éƒ¨ç½²ï¼Œæ”¯æŒæ•æ·å¼€å‘å’Œå¿«é€Ÿè¿­ä»£
- **ç±»å‹å®‰å…¨ä¿éšœ**: å…¨æ ˆ TypeScript æ”¯æŒï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯ï¼Œæå‡ä»£ç è´¨é‡

### **ğŸ“Š é‡åŒ–æˆæœ**
- **8ä¸ªåŠŸèƒ½åŒ…**: å®Œæ•´çš„æ¨¡å—åŒ–æ¶æ„ä½“ç³»
- **67%ç¯å¢ƒå˜é‡å‡å°‘**: ç®€åŒ–é…ç½®ç®¡ç†
- **3ç§è¯­è¨€æ”¯æŒ**: å›½é™…åŒ–é‚®ä»¶æ¨¡æ¿ç³»ç»Ÿ
- **6ç§é‚®ä»¶ç±»å‹**: å®Œæ•´çš„ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸé‚®ä»¶è¦†ç›–
- **3å±‚å®‰å…¨éªŒè¯**: å›¾ç‰‡ä¸Šä¼ å®‰å…¨ä¿éšœ
- **é›¶ä¾èµ–æ¨èç³»ç»Ÿ**: æç®€é«˜æ•ˆçš„ç”¨æˆ·è·å®¢å·¥å…·

## **ğŸ”§ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—**

### **1. æ”¯ä»˜ç³»ç»Ÿ (@rolitt/payments)**

**å®Œæ•´çš„æ”¯ä»˜è§£å†³æ–¹æ¡ˆ**:

- ğŸ’³ **Stripe é›†æˆ**: å®Œæ•´çš„æ”¯ä»˜æµç¨‹å’Œ Webhook å¤„ç†
- ğŸ¨ **æ”¯ä»˜ UI ç»„ä»¶**: å¼€ç®±å³ç”¨çš„æ”¯ä»˜ç•Œé¢ç»„ä»¶
- ğŸ”„ **è®¢é˜…ç®¡ç†**: æ”¯æŒè®¢é˜…è®¡åˆ’å’Œå‘¨æœŸæ€§ä»˜æ¬¾
- ğŸ›¡ï¸ **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- ğŸ“Š **æ”¯ä»˜åˆ†æ**: æ”¯ä»˜æˆåŠŸç‡å’Œè½¬åŒ–ç‡ç»Ÿè®¡

**æ¶æ„ç‰¹ç‚¹**:
```tsx
// æ”¯ä»˜ä¼šè¯åˆ›å»º
import { createCheckoutSession } from '@rolitt/payments';

const session = await createCheckoutSession({
  priceId: 'price_xxx',
  customerId: 'cus_xxx',
  successUrl: '/success',
  cancelUrl: '/cancel'
});
```

### **2. æ¨èç³»ç»Ÿ (@rolitt/referral)**

**æç®€æ¨èæ¶æ„**:

- ğŸ¯ **3ä¸ªæ ¸å¿ƒå‡½æ•°**: `createReferral`ã€`trackClick`ã€`calculateReward`
- ğŸ”— **é›¶ä¾èµ–è®¾è®¡**: æ— å¤–éƒ¨ä¾èµ–ï¼Œæè‡´è½»é‡
- âš™ï¸ **Admin å¯é…ç½®**: åå°åŠ¨æ€é…ç½®æ¨èå‚æ•°
- ğŸ“± **ç¤¾äº¤åˆ†äº«**: å†…ç½®ç¤¾äº¤åª’ä½“åˆ†äº«åŠŸèƒ½
- ğŸ“Š **å®æ—¶ç»Ÿè®¡**: æ¨èæ•ˆæœå’Œè½¬åŒ–ç‡åˆ†æ

**ä½¿ç”¨ç¤ºä¾‹**:
```tsx
// åˆ›å»ºæ¨èé“¾æ¥
const referralCode = await createReferral(userId);
// è¿½è¸ªç‚¹å‡»
await trackClick(referralCode, visitorId);
// è®¡ç®—å¥–åŠ±
const reward = await calculateReward(referralCode);
```

### **3. å›¾ç‰‡ä¸Šä¼ ç³»ç»Ÿ (@rolitt/image-upload)**

**å®‰å…¨çš„å›¾ç‰‡å¤„ç†**:

- ğŸ”’ **ä¸‰å±‚å®‰å…¨éªŒè¯**: æ–‡ä»¶ç±»å‹ã€å¤§å°ã€é­”æ•°æ£€æŸ¥
- â˜ï¸ **Cloudflare R2**: é«˜æ€§èƒ½å¯¹è±¡å­˜å‚¨
- ğŸ¨ **React Hooks**: `useImageUpload` ç®€åŒ–é›†æˆ
- ğŸ¤– **AI å°±ç»ª**: ä¸º ChatGPT å›¾ç‰‡è¯†åˆ«é¢„ç•™æ¥å£
- ğŸ“± **ç§»åŠ¨ç«¯ä¼˜åŒ–**: æ”¯æŒç§»åŠ¨è®¾å¤‡å›¾ç‰‡ä¸Šä¼ 

**æŠ€æœ¯å®ç°**:
```tsx
// React Hook ä½¿ç”¨ç¤ºä¾‹
function ImageUploadComponent() {
  const { uploadImage, isUploading, error } = useImageUpload();

  const handleUpload = async (file: File) => {
    const result = await uploadImage(file);
    console.log('ä¸Šä¼ æˆåŠŸ:', result.url);
  };

  return (
    <input type="file" onChange={e => handleUpload(e.target.files[0])} />
  );
}
```

### **4. é‚®ä»¶æ¨¡æ¿ç³»ç»Ÿ (@rolitt/email)**

**ä¼ä¸šçº§é‚®ä»¶è§£å†³æ–¹æ¡ˆ**:

- ğŸŒ **å¤šè¯­è¨€æ”¯æŒ**: è‹±è¯­ã€è¥¿ç­ç‰™è¯­ã€æ—¥è¯­ã€ç¹ä½“ä¸­æ–‡
- ğŸ“§ **6ç§é‚®ä»¶ç±»å‹**: é‚€è¯·ã€ç¡®è®¤ã€å¯†ç æ¢å¤ã€é­”æ³•é“¾æ¥ç­‰
- ğŸ¨ **ä¸“ä¸šè®¾è®¡**: å“åº”å¼é‚®ä»¶æ¨¡æ¿
- ğŸ”§ **Supabase é›†æˆ**: æ— ç¼é›†æˆ Supabase Auth
- âš¡ **ä¸€é”®éƒ¨ç½²**: è‡ªåŠ¨åŒ–é…ç½®å’Œéƒ¨ç½²è„šæœ¬

**é‚®ä»¶ç±»å‹è¦†ç›–**:
- âœ‰ï¸ ç”¨æˆ·é‚€è¯· (invite)
- âœ… é‚®ç®±ç¡®è®¤ (confirmation)
- ğŸ”‘ å¯†ç æ¢å¤ (recovery)
- âœ¨ é­”æ³•é“¾æ¥ (magic_link)
- ğŸ”„ é‚®ç®±å˜æ›´ (email_change)
- ğŸ” é‡æ–°è®¤è¯ (reauthentication)

### **5. Shopify é›†æˆ (@rolitt/shopify)**

**å®Œå…¨è§£è€¦çš„ç”µå•†é›†æˆ**:

- ğŸ›’ **äº§å“åŒæ­¥**: è‡ªåŠ¨åŒæ­¥äº§å“ä¿¡æ¯å’Œåº“å­˜
- ğŸ“¦ **è®¢å•ç®¡ç†**: å®Œæ•´çš„è®¢å•ç”Ÿå‘½å‘¨æœŸç®¡ç†
- ğŸ”„ **åº“å­˜æ§åˆ¶**: å®æ—¶åº“å­˜åŒæ­¥å’Œé¢„è­¦
- ğŸ¯ **æ’ä»¶åŒ–è®¾è®¡**: å¯é€‰å¯ç”¨/ç¦ç”¨åŠŸèƒ½æ¨¡å—
- ğŸ“Š **æ•°æ®åˆ†æ**: é”€å”®æ•°æ®å’Œè¶‹åŠ¿åˆ†æ

**æ ¸å¿ƒåŠŸèƒ½**:
```tsx
// äº§å“åŒæ­¥
import { syncInventory, syncProducts } from '@rolitt/shopify';

await syncProducts(); // åŒæ­¥äº§å“ä¿¡æ¯
await syncInventory(); // åŒæ­¥åº“å­˜æ•°æ®
```

### **6. ç®¡ç†ç³»ç»Ÿ (@rolitt/admin)**

**ç‹¬ç«‹çš„ç®¡ç†åå°**:

- ğŸ‘¥ **ç”¨æˆ·ç®¡ç†**: å®Œæ•´çš„ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸç®¡ç†
- ğŸ“Š **æ•°æ®åˆ†æ**: ä¸šåŠ¡æŒ‡æ ‡å’Œç”¨æˆ·è¡Œä¸ºåˆ†æ
- âš™ï¸ **ç³»ç»Ÿé…ç½®**: åŠ¨æ€é…ç½®ç³»ç»Ÿå‚æ•°
- ğŸ” **æƒé™æ§åˆ¶**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
- ğŸ“‹ **å®¡è®¡æ—¥å¿—**: å®Œæ•´çš„æ“ä½œè®°å½•å’Œè¿½è¸ª

### **7. è®¤è¯ç³»ç»Ÿ (@rolitt/auth)**

**åŒè®¤è¯æ¶æ„**:

- ğŸ” **Supabase Auth**: Web ç«¯ä¸»è®¤è¯ç³»ç»Ÿ
- ğŸ”¥ **Firebase Auth**: ç§»åŠ¨ç«¯å’Œå®¹ç¾å¤‡ä»½
- ğŸ”„ **æ•°æ®åŒæ­¥**: åŸºäºé‚®ç®±çš„ç»Ÿä¸€ç”¨æˆ·æ ‡è¯†
- ğŸ›¡ï¸ **å®‰å…¨ä¿éšœ**: å¤šå› ç´ è®¤è¯å’Œå®‰å…¨ç­–ç•¥
- ğŸ“± **å¤šå¹³å°æ”¯æŒ**: Webã€ç§»åŠ¨ç«¯æ— ç¼åˆ‡æ¢

### **8. å…±äº«ç»„ä»¶åº“ (@rolitt/shared)**

**ç»Ÿä¸€çš„ç»„ä»¶ç”Ÿæ€**:

- ğŸ¨ **UI ç»„ä»¶**: å¯å¤ç”¨çš„ç•Œé¢ç»„ä»¶
- ğŸ”§ **å·¥å…·å‡½æ•°**: é€šç”¨çš„ä¸šåŠ¡é€»è¾‘
- ğŸ“ **ç±»å‹å®šä¹‰**: å…¨å±€ç±»å‹å’Œæ¥å£
- ğŸ¯ **è®¾è®¡ç³»ç»Ÿ**: ç»Ÿä¸€çš„è®¾è®¡è§„èŒƒ
- ğŸ“š **æ–‡æ¡£æ”¯æŒ**: Storybook ç»„ä»¶æ–‡æ¡£

## **ğŸ—ï¸ æŠ€æœ¯æ¶æ„æ¦‚è§ˆ**

### **ğŸ“¦ Monorepo æ¶æ„**

```
rolitt-main/
â”œâ”€â”€ src/                   # ä¸»åº”ç”¨ä»£ç 
â”‚   â”œâ”€â”€ app/              # Next.js App Router
â”‚   â”œâ”€â”€ components/       # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ libs/            # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â””â”€â”€ models/          # æ•°æ®æ¨¡å‹å’Œ Schema
â”œâ”€â”€ packages/             # åŠŸèƒ½åŒ…ç”Ÿæ€
â”‚   â”œâ”€â”€ admin/           # ç®¡ç†ç³»ç»ŸåŒ…
â”‚   â”œâ”€â”€ auth/            # è®¤è¯ç³»ç»ŸåŒ…
â”‚   â”œâ”€â”€ email/           # é‚®ä»¶æ¨¡æ¿åŒ…
â”‚   â”œâ”€â”€ image-upload/    # å›¾ç‰‡ä¸Šä¼ åŒ…
â”‚   â”œâ”€â”€ payments/        # æ”¯ä»˜ç³»ç»ŸåŒ…
â”‚   â”œâ”€â”€ referral/        # æ¨èç³»ç»ŸåŒ…
â”‚   â”œâ”€â”€ shared/          # å…±äº«ç»„ä»¶åŒ…
â”‚   â””â”€â”€ shopify/         # Shopify é›†æˆåŒ…
â””â”€â”€ migrations/          # æ•°æ®åº“è¿ç§»æ–‡ä»¶
```

### **ğŸ”„ æ•°æ®æµæ¶æ„**

```mermaid
graph TD
    A["ğŸ‘¤ ç”¨æˆ·æ“ä½œ"] --> B["ğŸ¨ UI ç»„ä»¶"]
    B --> C["ğŸ”§ ä¸šåŠ¡é€»è¾‘"]
    C --> D["ğŸ“¦ åŠŸèƒ½åŒ…"]
    D --> E["ğŸ—„ï¸ æ•°æ®åº“"]

    E --> F["ğŸ“Š åˆ†æç³»ç»Ÿ"]
    E --> G["ğŸ”” Webhook"]
    G --> H["ğŸ“§ é‚®ä»¶ç³»ç»Ÿ"]
    G --> I["ğŸ“ˆ è¥é”€è‡ªåŠ¨åŒ–"]

    style A fill:#10b981
    style D fill:#3b82f6
    style E fill:#f59e0b
    style F fill:#8b5cf6
```

### **ğŸ›¡ï¸ å®‰å…¨æ¶æ„**

- **è®¤è¯å±‚**: åŒè®¤è¯ç³»ç»Ÿ (Supabase + Firebase)
- **æˆæƒå±‚**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ (RBAC)
- **æ•°æ®å±‚**: PostgreSQL è¡Œçº§å®‰å…¨ (RLS)
- **ä¼ è¾“å±‚**: HTTPS + API å¯†é’¥éªŒè¯
- **ç›‘æ§å±‚**: Sentry é”™è¯¯è¿½è¸ª + å®¡è®¡æ—¥å¿—

### **âš¡ æ€§èƒ½ä¼˜åŒ–**

- **ç¼“å­˜ç­–ç•¥**: Redis å¤šå±‚ç¼“å­˜ + CDN
- **ä»£ç åˆ†å‰²**: åŠ¨æ€å¯¼å…¥ + åŒ…çº§åˆ«åˆ†å‰²
- **å›¾ç‰‡ä¼˜åŒ–**: Next.js Image + Cloudflare R2
- **æ•°æ®åº“**: è¿æ¥æ±  + æŸ¥è¯¢ä¼˜åŒ–
- **ç›‘æ§**: å®æ—¶æ€§èƒ½æŒ‡æ ‡ + é”™è¯¯è¿½è¸ª

## **ğŸ—ï¸ æœ€æ–°æ¶æ„å‡çº§**

### **ğŸš€ æ ¸å¿ƒæŠ€æœ¯æ ˆ**

- **å‰ç«¯æ¡†æ¶**: Next.js 15 + React 18 + TypeScript
- **æ•°æ®åº“**: PostgreSQL + Drizzle ORM
- **è®¤è¯ç³»ç»Ÿ**: Supabase Auth + Firebase Auth (åŒè®¤è¯)
- **ç¼“å­˜ç³»ç»Ÿ**: Redis (æ¨è Upstash)
- **æ”¯ä»˜ç³»ç»Ÿ**: Stripe + Webhook å¤„ç†
- **éƒ¨ç½²å¹³å°**: Railway + Vercel + Cloudflare
- **ç›‘æ§ç³»ç»Ÿ**: Sentry + PostHog + Google Analytics

### **ğŸ“Š ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡**

- **ğŸ—ï¸ æ¶æ„å¤æ‚åº¦**: 8ä¸ªç‹¬ç«‹åŠŸèƒ½åŒ…ï¼Œæ¨¡å—åŒ–ç¨‹åº¦ 95%
- **âš¡ å¼€å‘æ•ˆç‡**: ç¯å¢ƒå˜é‡å‡å°‘ 67%ï¼Œæ„å»ºæ—¶é—´ä¼˜åŒ– 40%
- **ğŸ”’ å®‰å…¨ç­‰çº§**: åŒè®¤è¯ç³»ç»Ÿï¼Œå®‰å…¨è¦†ç›–ç‡ 100%
- **ğŸŒ å›½é™…åŒ–**: 4ç§è¯­è¨€æ”¯æŒï¼Œå¤šè¯­è¨€è¦†ç›–ç‡ 100%
- **ğŸ“± å“åº”å¼**: ç§»åŠ¨ç«¯é€‚é…ç‡ 100%ï¼ŒPWA å°±ç»ª

### **ğŸ”„ æ•°æ®åŒæ­¥ç­–ç•¥**

**æ™ºèƒ½æ•°æ®æµç®¡ç†**:

```mermaid
graph LR
    A["ğŸ” Supabase Auth"] --> C["ğŸ“Š PostgreSQL"]
    B["ğŸ”¥ Firebase Auth"] --> C
    C --> D["ğŸ”„ æ•°æ®åŒæ­¥"]
     D --> E["ğŸ“ˆ ä¸šåŠ¡åˆ†æ"]
     D --> F["ğŸ“§ é‚®ä»¶ç³»ç»Ÿ"]
     D --> G["ğŸ’³ æ”¯ä»˜ç³»ç»Ÿ"]

     style A fill:#10b981
     style B fill:#f59e0b
     style C fill:#3b82f6
     style D fill:#8b5cf6
 ```

### **ğŸ›¡ï¸ å®‰å…¨ä¸åˆè§„å‡çº§**

- **é›¶ä¿¡ä»»æ¶æ„**: æ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦éªŒè¯
- **å¤šå±‚é˜²æŠ¤**: è®¤è¯ â†’ æˆæƒ â†’ æ•°æ®è®¿é—®æ§åˆ¶
- **å®¡è®¡è¿½è¸ª**: å®Œæ•´çš„æ“ä½œæ—¥å¿—å’Œç”¨æˆ·è¡Œä¸ºè®°å½•
- **æ•°æ®åŠ å¯†**: ä¼ è¾“åŠ å¯† + å­˜å‚¨åŠ å¯†
- **åˆè§„æ ‡å‡†**: GDPR + PCI DSS + SOC 2

### **âš¡ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥**

**ç¼“å­˜æ¶æ„**:
- **L1 ç¼“å­˜**: æµè§ˆå™¨ç¼“å­˜ + Service Worker
- **L2 ç¼“å­˜**: CDN è¾¹ç¼˜ç¼“å­˜ (Cloudflare)
- **L3 ç¼“å­˜**: Redis åº”ç”¨ç¼“å­˜
- **L4 ç¼“å­˜**: æ•°æ®åº“æŸ¥è¯¢ç¼“å­˜

**ä»£ç ä¼˜åŒ–**:
- **åŒ…çº§åˆ«åˆ†å‰²**: æ¯ä¸ªåŠŸèƒ½åŒ…ç‹¬ç«‹åŠ è½½
- **åŠ¨æ€å¯¼å…¥**: æŒ‰éœ€åŠ è½½ç»„ä»¶å’ŒåŠŸèƒ½
- **Tree Shaking**: è‡ªåŠ¨ç§»é™¤æœªä½¿ç”¨ä»£ç 
- **å›¾ç‰‡ä¼˜åŒ–**: WebP + å“åº”å¼å›¾ç‰‡ + æ‡’åŠ è½½

### **ğŸ”§ å¼€å‘ä½“éªŒå‡çº§**

**å¼€å‘å·¥å…·é“¾**:
- **ç±»å‹å®‰å…¨**: 100% TypeScript è¦†ç›–
- **ä»£ç è´¨é‡**: ESLint + Prettier + Husky
- **æµ‹è¯•è¦†ç›–**: Vitest + Playwright E2E
- **æ–‡æ¡£ç³»ç»Ÿ**: Storybook + è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£
- **CI/CD**: GitHub Actions + è‡ªåŠ¨éƒ¨ç½²

**è°ƒè¯•å’Œç›‘æ§**:
- **é”™è¯¯è¿½è¸ª**: Sentry å®æ—¶é”™è¯¯ç›‘æ§
- **æ€§èƒ½ç›‘æ§**: Web Vitals + è‡ªå®šä¹‰æŒ‡æ ‡
- **æ—¥å¿—ç³»ç»Ÿ**: ç»“æ„åŒ–æ—¥å¿— + æœç´¢åŠŸèƒ½
- **å¥åº·æ£€æŸ¥**: ç³»ç»ŸçŠ¶æ€å®æ—¶ç›‘æ§

### **ğŸ›’ Shopify é›†æˆæˆ˜ç•¥**

é‡‡ç”¨"ç”¨æˆ·ç³»ç»Ÿä¸ºæ ¸å¿ƒ"çš„é›†æˆç­–ç•¥ï¼š

```mermaid
graph LR
    A["ğŸ‘¤ ç”¨æˆ·ç³»ç»Ÿ<br/>(æ•°æ®ä¸»æƒ)"] --> B["ğŸ“¦ è®¢å•æ•°æ®"]
    B --> C["ğŸ”„ å•å‘æ¨é€"]
    C --> D["ğŸ›’ Shopify<br/>(å±¥çº¦å·¥å…·)"]

    D --> E["ğŸ“‹ åº“å­˜ç®¡ç†"]
    D --> F["ğŸšš ç‰©æµé…é€"]
    D --> G["ğŸ“ å®¢æœæ”¯æŒ"]

    style A fill:#10b981
    style D fill:#95f3d9
    style E fill:#fbbf24
    style F fill:#f472b6
    style G fill:#a78bfa
```

**æˆ˜ç•¥ä»·å€¼**ï¼š
- ğŸ›ï¸ **æ•°æ®ä¸»æƒ**: æ•æ„Ÿæ•°æ®ä¿ç•™åœ¨è‡ªæœ‰ç³»ç»Ÿ
- ğŸ”„ **å•å‘æ•°æ®æµ**: åªæ¨é€å±¥çº¦å¿…éœ€ä¿¡æ¯
- ğŸš€ **å¿«é€Ÿæ‰©å±•**: åˆ©ç”¨ Shopify æˆç†Ÿçš„å±¥çº¦èƒ½åŠ›
- ğŸ’° **æˆæœ¬ä¼˜åŒ–**: å‡å°‘è‡ªå»ºç‰©æµç³»ç»ŸæŠ•å…¥

## **ğŸŒ å›½é™…åŒ–æ”¯æŒ**

### **æ”¯æŒè¯­è¨€**

- ğŸ‡ºğŸ‡¸ English (é»˜è®¤)
- ğŸ‡ªğŸ‡¸ EspaÃ±ol (è¥¿ç­ç‰™è¯­)
- ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª (æ—¥è¯­)
- ğŸ‡­ğŸ‡° ç¹é«”ä¸­æ–‡ (ç¹ä½“ä¸­æ–‡)

### **å®ç°ç‰¹æ€§**

- ğŸ”— åŠ¨æ€è·¯ç”± `[locale]`
- ğŸ¤– è‡ªåŠ¨è¯­è¨€æ£€æµ‹
- ğŸ” SEO å‹å¥½çš„å¤šè¯­è¨€ URL
- ğŸ¨ å®Œæ•´çš„ UI ç¿»è¯‘

## **ğŸ”’ å®‰å…¨ä¸åˆè§„**

### **å®‰å…¨æªæ–½**

- **èº«ä»½éªŒè¯**: Supabase Auth ä¸»ç³»ç»Ÿ + Firebase Auth å®¹ç¾
- **æ•°æ®ä¿æŠ¤**: PostgreSQL è¡Œçº§å®‰å…¨ + Supabase RLS
- **API å®‰å…¨**: è¯·æ±‚éªŒè¯å’Œé€Ÿç‡é™åˆ¶
- **ç¯å¢ƒå˜é‡**: ç±»å‹å®‰å…¨çš„é…ç½®ç®¡ç†
- **é”™è¯¯ç›‘æ§**: Sentry å®æ—¶é”™è¯¯è¿½è¸ª
- **å¤šå±‚è®¤è¯**: åŒè®¤è¯ç³»ç»Ÿä¿è¯é«˜å¯ç”¨æ€§

### **åˆè§„æ ‡å‡†**

- âœ… GDPR æ•°æ®ä¿æŠ¤åˆè§„
- âœ… PCI DSS æ”¯ä»˜å®‰å…¨æ ‡å‡†
- âœ… å®¡è®¡æ—¥å¿—ç³»ç»Ÿ
- âœ… æ•°æ®åŠ å¯†å’Œå¤‡ä»½

## **ğŸš€ å¿«é€Ÿå¼€å§‹**

### **ç¯å¢ƒå‡†å¤‡**

1. **å…‹éš†é¡¹ç›®**

```bash
git clone https://github.com/your-org/rolitt-main.git
cd rolitt-main

```

1. **å®‰è£…ä¾èµ–**

```bash
npm install

```

1. **ç¯å¢ƒé…ç½®** åˆ›å»º `.env.local` æ–‡ä»¶ï¼š

```
# æ•°æ®åº“é…ç½®
DATABASE_URL="postgresql://user:password@localhost:5432/rolitt"

# ç¼“å­˜é…ç½® (æ¨è Upstash)
# Upstash Redis (æ¨è) - è‡ªåŠ¨å¤‡ä»½ã€å…¨çƒåˆ†å¸ƒã€æŒ‰éœ€ä»˜è´¹
REDIS_URL="redis://default:your_password@your-redis.upstash.io:6379"
# æœ¬åœ°å¼€å‘å¯ä½¿ç”¨: redis://localhost:6379

# Supabase é…ç½® (ä¸»è®¤è¯ç³»ç»Ÿ)
NEXT_PUBLIC_SUPABASE_URL="your_supabase_url"
NEXT_PUBLIC_SUPABASE_ANON_KEY="your_supabase_anon_key"

# Firebase é…ç½® (å®¹ç¾å¤‡ä»½)
NEXT_PUBLIC_FIREBASE_API_KEY="your_api_key"
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN="your_domain"
NEXT_PUBLIC_FIREBASE_PROJECT_ID="your_project_id"
NEXT_PUBLIC_FIREBASE_APP_ID="your_app_id"
FIREBASE_SERVICE_ACCOUNT_KEY="your_service_account_json"

# Stripe é…ç½®
STRIPE_SECRET_KEY="sk_test_..."
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY="pk_test_..."
STRIPE_WEBHOOK_SECRET="whsec_..."
COLOR_PRICE_MAP_JSON='{"Healing Green":"price_xxx","Moonlight Grey":"price_xxx"}'

# Klaviyo é…ç½®
KLAVIYO_API_KEY="your_klaviyo_key"

# åº”ç”¨é…ç½®
NEXT_PUBLIC_APP_URL="http://localhost:3000"
APP_URL="http://localhost:3000"

```

1. **åŒ…ä¾èµ–å®‰è£…**

```bash
npm run packages:install # å®‰è£…æ‰€æœ‰åŒ…ä¾èµ–
```

1. **æ•°æ®åº“åˆå§‹åŒ–**

```bash
npm run db:generate # ç”Ÿæˆè¿ç§»æ–‡ä»¶
npm run db:migrate # æ‰§è¡Œæ•°æ®åº“è¿ç§»
```

1. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**

```bash
npm run dev

```

### **å¼€å‘è„šæœ¬**

```bash
# å¼€å‘
npm run dev # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev:next # Next.js å¼€å‘æœåŠ¡å™¨
npm run admin:dev # Admin åŒ…å¼€å‘æ¨¡å¼

# æ„å»ºå’Œæµ‹è¯•
npm run build # ç”Ÿäº§æ„å»º
npm run test # å•å…ƒæµ‹è¯•
npm run test:e2e # E2E æµ‹è¯•
npm run lint # ä»£ç æ£€æŸ¥
npm run type-check # ç±»å‹æ£€æŸ¥

# æ•°æ®åº“
npm run db:generate # ç”Ÿæˆè¿ç§»
npm run db:migrate # æ‰§è¡Œè¿ç§»
npm run db:studio # æ•°æ®åº“ç®¡ç†ç•Œé¢

# Shopify é›†æˆåŒ…
npm run test:shopify # æµ‹è¯• Shopify åŒ…
npm run admin:check # Admin åŒ…ç±»å‹æ£€æŸ¥
npm run admin:validate # Admin åŒ…éªŒè¯

# é‚®ä»¶æ¨¡æ¿ç³»ç»Ÿ
npm run email:setup # ç”Ÿæˆé‚®ä»¶æ¨¡æ¿é…ç½®
npm run email:generate # ä»…ç”Ÿæˆæ¨¡æ¿æ–‡ä»¶
npm run email:test # æµ‹è¯•é‚®ä»¶æ¨¡æ¿
npm run email:validate # éªŒè¯é‚®ä»¶æ¨¡æ¿

# åŒ…ç®¡ç†
npm run packages:install # å®‰è£…æ‰€æœ‰åŒ…ä¾èµ–
npm run packages:build # æ„å»ºæ‰€æœ‰åŒ…
npm run packages:clean # æ¸…ç†åŒ…æ„å»ºäº§ç‰©
# å·¥å…·
npm run check-env # ç¯å¢ƒå˜é‡æ£€æŸ¥
npm run storybook # ç»„ä»¶æ–‡æ¡£
```

## **ğŸ“Š ç›‘æ§å’Œè°ƒè¯•**

### **å¥åº·æ£€æŸ¥**

è®¿é—® `/api/webhook/health` æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€ï¼š

```json
{
  "status": "ok",
  "services": {
    "database": "connected",
    "stripe": "configured",
    "klaviyo": "configured"
  }
}
```

### **Webhook æ—¥å¿—**

ç®¡ç†åå°æä¾›å®Œæ•´çš„ webhook æ—¥å¿—ç›‘æ§ï¼š

- ğŸ“Š äº‹ä»¶å¤„ç†ç»Ÿè®¡
- ğŸ” é”™è¯¯åˆ†æå’Œè°ƒè¯•
- ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡ç›‘æ§

### **æ„å»ºåˆ†æ**

```bash
npm run build-stats# åˆ†æåŒ…å¤§å°
npm run lighthouse# æ€§èƒ½è¯„ä¼°
```

## **ğŸ§ª æµ‹è¯•ç­–ç•¥**

### **æµ‹è¯•ç±»å‹**

- **å•å…ƒæµ‹è¯•**: Vitest + Testing Library
- **E2E æµ‹è¯•**: Playwright å¤šæµè§ˆå™¨æµ‹è¯•
- **ç»„ä»¶æµ‹è¯•**: Storybook ç»„ä»¶æ–‡æ¡£
- **æ”¯ä»˜æµ‹è¯•**: Stripe æµ‹è¯•å¡å·
- **åŒ…é›†æˆæµ‹è¯•**: Admin åŒ…ä¸ä¸»åº”ç”¨é›†æˆæµ‹è¯•

### **å…³é”®æµ‹è¯•åœºæ™¯**

- âœ… å®Œæ•´çš„æ”¯ä»˜æµç¨‹
- âœ… åŒè®¤è¯ç³»ç»Ÿåˆ‡æ¢
- âœ… Admin åŒ…åŠŸèƒ½å®Œæ•´æ€§
- âœ… å¤šè¯­è¨€åŠŸèƒ½
- âœ… å“åº”å¼è®¾è®¡
- âœ… Webhook äº‹ä»¶å¤„ç†
- âœ… åŒ…é—´é€šä¿¡æœºåˆ¶

## **ğŸš€ éƒ¨ç½²é€‰é¡¹**

### **1. Vercel (æ¨è)**

```bash
npm run build
vercel deploy

```

### **2. Cloudflare Workers**

```bash
npx opennextjs-cloudflare# æ„å»º
npx wrangler pages dev .worker-next/# æœ¬åœ°æµ‹è¯•
npx wrangler pages deploy .worker-next/# éƒ¨ç½²
```

### **ç¯å¢ƒå˜é‡é…ç½®**

åœ¨éƒ¨ç½²å¹³å°é…ç½®ç›¸åº”çš„ç¯å¢ƒå˜é‡ï¼Œç¡®ä¿æ‰€æœ‰æœåŠ¡æ­£å¸¸å·¥ä½œã€‚

## **ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–**

### **Core Web Vitals ç›®æ ‡**

- **LCP**: < 2.5s
- **FID**: < 100ms
- **CLS**: < 0.1

### **ä¼˜åŒ–ç­–ç•¥**

- ğŸš€ Server Components ä¼˜å…ˆ
- ğŸ–¼ï¸ Next.js Image ä¼˜åŒ–
- ğŸ“ å­—ä½“ä¼˜åŒ–å’Œé¢„åŠ è½½
- ğŸ“¦ ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½
- ğŸ’¾ å¤šå±‚ç¼“å­˜ç­–ç•¥

## **ğŸ¤ è´¡çŒ®æŒ‡å—**

### **å¼€å‘è§„èŒƒ**

- ğŸ“ éµå¾ª `.cursorrules` å¼€å‘è§„èŒƒ
- ğŸ” TypeScript Strict Mode
- ğŸ’… ESLint + Prettier ä»£ç æ ¼å¼åŒ–
- ğŸ“‹ Conventional Commits æäº¤è§„èŒƒ

### **Pull Request æµç¨‹**

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. éµå¾ªä»£ç è§„èŒƒè¿›è¡Œå¼€å‘
4. è¿è¡Œæµ‹è¯•ç¡®ä¿è´¨é‡ (`npm run test`)
5. æäº¤æ›´æ”¹ (`npm run commit`)
6. æ¨é€åˆ†æ”¯ (`git push origin feature/amazing-feature`)
7. åˆ›å»º Pull Request

## **ğŸ“š æ–‡æ¡£èµ„æº**

- ğŸ“– [æ”¯ä»˜ç³»ç»Ÿæ¶æ„æ–‡æ¡£](docs/payment-system-architecture.md)
- ğŸ”§ [æ”¯ä»˜ç³»ç»Ÿä¿®å¤è®°å½•](docs/payment-system-hotfix-2025-06-28.md)
- ğŸ“‹ [æ›´æ–°æ—¥å¿—](docs/CHANGELOG.md)
- ğŸ” [è®¤è¯ç³»ç»Ÿè¿ç§»æŒ‡å—](log/2025-01-02-22-05-firebase-to-supabase-auth-migration-completion.md)
- ğŸ“¦ [Admin åŒ…è§£è€¦æ–‡æ¡£](log/2025-01-02-22-05-admin-package-decoupling-foundation-completion.md)
- ğŸ›’ [Shopify é›†æˆæˆ˜ç•¥](pm/shopify-integration-strategy-roadmap.md)
- ğŸ“Š [è¥é”€è½¬åŒ–åˆ†æ](pm/user-conversion-marketing-analysis.md)
- ğŸš€ [Redis Upstash è¿ç§»æŒ‡å—](docs/redis-upstash-migration-guide.md)

## **ğŸ¯ ç³»ç»Ÿæ¼”è¿›æ€»ç»“**

### **ğŸš€ 2025å¹´é‡å¤§æ¶æ„å‡çº§**

æœ¬æ¬¡æ›´æ–°ä»£è¡¨äº† Rolitt ç³»ç»Ÿçš„é‡å¤§æ¶æ„å‡çº§ï¼Œå®ç°äº†ä»å•ä½“åº”ç”¨å‘ç°ä»£åŒ–å¾®æœåŠ¡æ¶æ„çš„è½¬å‹ï¼š

#### **æ ¸å¿ƒæˆå°±**
- âœ… **è®¤è¯ç³»ç»Ÿç°ä»£åŒ–**: Firebase â†’ Supabase è¿ç§»ï¼Œç¯å¢ƒå¤æ‚åº¦é™ä½ 67%
- âœ… **æ¨¡å—åŒ–æ¶æ„**: Admin åŒ…è§£è€¦ï¼Œæ”¯æŒå¹¶è¡Œå¼€å‘å’Œç‹¬ç«‹éƒ¨ç½²
- âœ… **è¥é”€ç­–ç•¥ä¼˜åŒ–**: ç²¾å‡†è½¬åŒ–æ¼æ–—å’Œ Shopify é›†æˆæˆ˜ç•¥
- âœ… **å®¹ç¾èƒ½åŠ›æå‡**: åŒè®¤è¯ç³»ç»Ÿä¿è¯ 99.9% å¯ç”¨æ€§
- âœ… **å¼€å‘æ•ˆç‡æå‡**: åŒ…ç®¡ç†å’Œç±»å‹å®‰å…¨è¦†ç›–ç‡è¾¾åˆ° 100%

#### **æŠ€æœ¯å€ºåŠ¡æ¸…ç†**
- ğŸ”§ è§£å†³äº† Railway éƒ¨ç½²ä¸ç¨³å®šé—®é¢˜
- ğŸ”§ ç®€åŒ–äº†ç¯å¢ƒå˜é‡é…ç½®å¤æ‚æ€§
- ğŸ”§ å»ºç«‹äº†å®Œæ•´çš„é”™è¯¯ç›‘æ§å’Œæ—¥å¿—ç³»ç»Ÿ
- ğŸ”§ å®ç°äº†æ•°æ®ä¸€è‡´æ€§ä¿è¯æœºåˆ¶

#### **ä¸šåŠ¡ä»·å€¼å®ç°**
- ğŸ“ˆ **è½¬åŒ–ç‡æå‡**: æ”¯ä»˜é©±åŠ¨çš„ç”¨æˆ·åˆ›å»ºç­–ç•¥
- ğŸ’° **æˆæœ¬ä¼˜åŒ–**: åˆ©ç”¨ Shopify å±¥çº¦èƒ½åŠ›ï¼Œå‡å°‘è‡ªå»ºæŠ•å…¥
- ğŸ¯ **ç²¾å‡†è¥é”€**: åŸºäºçœŸå®è´­ä¹°è¡Œä¸ºçš„è¥é”€æŠ•å…¥
- ğŸŒ **å¤šå¹³å°å°±ç»ª**: Web + Flutter ç»Ÿä¸€ç”¨æˆ·ä½“ç³»

### **ğŸ”® æœªæ¥å‘å±•è§„åˆ’**

#### **çŸ­æœŸç›®æ ‡ (Q1 2025)**
- ğŸš€ å®Œæˆ Shopify é›†æˆçš„åŸºç¡€åŠŸèƒ½å®ç°
- ğŸ“± å¯åŠ¨ Flutter ç§»åŠ¨ç«¯å¼€å‘
- ğŸ”„ ä¼˜åŒ– Admin åŒ…çš„åŠŸèƒ½å®Œæ•´æ€§
- ğŸ“Š å»ºç«‹å®Œæ•´çš„æ•°æ®åˆ†æä»ªè¡¨æ¿

#### **ä¸­æœŸç›®æ ‡ (Q2-Q3 2025)**
- ğŸŒ æ‰©å±•åˆ°æ›´å¤šå›½é™…å¸‚åœº
- ğŸ¤– é›†æˆ AI é©±åŠ¨çš„ä¸ªæ€§åŒ–æ¨è
- ğŸ“¦ å»ºç«‹å®Œæ•´çš„åº“å­˜ç®¡ç†ç³»ç»Ÿ
- ğŸ” å®ç°ä¼ä¸šçº§å®‰å…¨è®¤è¯

#### **é•¿æœŸæ„¿æ™¯ (2025å¹´åº•)**
- ğŸ¢ æ„å»ºå®Œæ•´çš„ B2B é”€å”®æ¸ é“
- ğŸŒ å®ç°å…¨çƒåŒ–è¿è¥èƒ½åŠ›
- ğŸ¤– AI é©±åŠ¨çš„æ™ºèƒ½å®¢æœç³»ç»Ÿ
- ğŸ“ˆ å»ºç«‹æ•°æ®é©±åŠ¨çš„ä¸šåŠ¡å†³ç­–ä½“ç³»

---

**Rolitt æ­£åœ¨æˆä¸º AI ä¼´ä¾£äº§å“é¢†åŸŸçš„æŠ€æœ¯æ ‡æ†ï¼Œé€šè¿‡æŒç»­çš„æ¶æ„ä¼˜åŒ–å’Œåˆ›æ–°ï¼Œä¸ºç”¨æˆ·æä¾›å“è¶Šçš„äº§å“ä½“éªŒã€‚** ğŸš€

## **ğŸ“„ è®¸å¯è¯**

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## **ğŸ†˜ æŠ€æœ¯æ”¯æŒ**

- ğŸ“§ æŠ€æœ¯é—®é¢˜: æäº¤ Issue
- ğŸ“– æ–‡æ¡£é—®é¢˜: æ£€æŸ¥ `docs/` ç›®å½•
- ğŸ› Bug æŠ¥å‘Š: GitHub Issues
- ğŸ’¡ åŠŸèƒ½å»ºè®®: GitHub Discussions

---

**Rolitt** - è®© AI ä¼´ä¾£è§¦æ‰‹å¯åŠ ğŸ¤–âœ¨

*åŸºäº Next.js 15 çš„ç°ä»£åŒ–ç”µå•†å¹³å°ï¼Œä¸º AI ä¼´ä¾£äº§å“æä¾›å®Œæ•´çš„åœ¨çº¿è§£å†³æ–¹æ¡ˆã€‚*
